---
layout: post
title: Dynamic Distribution Group creation tool (PowerShell command generator to create Distribution Groups)
date: 2018-06-08 19:59
author: sammykrosoft
comments: true
categories: [Uncategorized]
permalink: /Exchange-Excel-PowerShell/Dynamic-Distribution-Group-PowerShell-Generator.html
---
<h1>I. Introduction</h1>
See the <a href="#Download">Download section below for the link to download the tool.</a>

In Exchange 2010/2013/2016 and Exchange Online (the messaging component of Office 365), we can create Dynamic Distribution Groups in two ways :
<ol>
 	<li>Using the Exchange Administration Console (HTML based)</li>
 	<li>Using the Exchange Management Shell (Command line based)</li>
</ol>
More information about the ways to create and manage Dynamic Distribution Groups on <a target="_blank" href="https://technet.microsoft.com/en-us/library/bb123722(v=exchg.150).aspx" rel="noopener">this link</a>…

The Dynamic Distribution Groups are a type of group that base their memberships on a query on other mail-enabled objects such as User Mailboxes, Room Mailboxes, or any object stamped with an e-mail address and that Exchange Server can read.
<blockquote>NOTE: When we use PowerShell to create a Dynamic Distribution Group, if we don’t specify the Scope of the query of a Dynamic Distribution Group, by default the scope will be the location where the Dynamic Distribution Group is created =&gt; and this is often something that takes hours until we found the cause of “non-working” Dynamic Distribution Groups, because everything else look very normal about these.</blockquote>
The tool I am giving here is meant to generate the PowerShell (Exchange Management Shell actually because you need the Exchange Tools to make it work) command line to create a Dynamic Distribution Group, without forgetting to specify the “scope” of the Dynamic Distribution Group filter.

Also, the other command line generated is meant to modify the scope and the filter of an exising Dynamic Distribution Group.

This is an Excel based PowerShell command generator, next challenge is to do the same but with WPF ! That will be for another blog post !
<h1>II. Tool description</h1>
<h2>a. General overview</h2>
<a href="https://msdnshared.blob.core.windows.net/media/2018/06/clip_image0027.png"><img width="854" height="648" title="clip_image002" alt="clip_image002" src="https://msdnshared.blob.core.windows.net/media/2018/06/clip_image002_thumb6.png" border="0" /></a>

The tool is composed of 2 main parts:
<ol>
 	<li>The <b>input part</b>, where we define the Dynamic Distribution Group <b>scope</b>, its <b>location</b> (an Organizational Unit), its <b>name</b>, optionally its <b>Alias</b> (that is what is used to generate the Dynamic DG e-mail address) – if you don’t specify it, Exchange will automatically convert the name into an alias, replacing all spaces and special characters with an hyphen or a dash (“-“).</li>
 	<li>The <b>PowerShell command</b> part, that you will copy and paste on an Exchange PowerShell window to create or modify your Dynamic Distribution Group. There are 2 command lines in that part :</li>
</ol>
<p style="padding-left: 60px">a. <pre>New-DynamicDistributionGroup</pre>-&gt; that is to create a new Dynamic Distribution Group with the parameters you chose on the part #1 – Input part.
b. <pre>Get-DynamicDistributionGroup</pre>-&gt; that is to <b><u>modify</u></b> an existing Dynamic Distribution Group with the <b><u>scope</u></b> and <b><u>filter</u></b> parameters you chose on the part #2 – Input part.</p>
<h2>b. Input details</h2>
See the below schema for the explanation of each input part.

<a href="https://msdnshared.blob.core.windows.net/media/2018/06/clip_image0045.png"><img width="854" height="629" title="clip_image004" alt="clip_image004" src="https://msdnshared.blob.core.windows.net/media/2018/06/clip_image004_thumb5.png" border="0" /></a>
<h2>c. Command part details</h2>
See the below schema for the explanation of the two PowerShell command lines.

<a href="https://msdnshared.blob.core.windows.net/media/2018/06/clip_image0063.png"><img width="854" height="538" title="clip_image006" alt="clip_image006" src="https://msdnshared.blob.core.windows.net/media/2018/06/clip_image006_thumb3.png" border="0" /></a>
<h1>III- Using these to create a new Dynamic DG or modify an existing Dynamic DG</h1>
<i>NOTE: for this last part, you need the following skills : ability to copy and paste things</i>

Once you have your command line ready, that are generated by the tool based on the input parameters you chose, just copy one of the command lines, and paste it on a script, or directly on the Exchange Management Shell.

Example, I want to create a new Dynamic Distribution Group with the sample options of the screenshots above :

<strong>- Step #1 : Select the blue box and hit CTRL + C</strong>

<a href="https://msdnshared.blob.core.windows.net/media/2018/06/clip_image0082.png"><img width="854" height="195" title="clip_image008" alt="clip_image008" src="https://msdnshared.blob.core.windows.net/media/2018/06/clip_image008_thumb2.png" border="0" /></a>

<strong>- Step #2 : Paste the command</strong>

You can choose either to paste the command on a <strong>Notepad</strong> to save it later as a .PS1 script:

<a href="https://msdnshared.blob.core.windows.net/media/2018/06/clip_image0102.png"><img width="854" height="516" title="clip_image010" alt="clip_image010" src="https://msdnshared.blob.core.windows.net/media/2018/06/clip_image010_thumb2.png" border="0" /></a>

Or you can paste it on a <strong>PowerShell ISE</strong> window on your remote connected server:

<a href="https://msdnshared.blob.core.windows.net/media/2018/06/clip_image0122.png"><img width="854" height="478" title="clip_image012" alt="clip_image012" src="https://msdnshared.blob.core.windows.net/media/2018/06/clip_image012_thumb2.png" border="0" /></a>

Or you can directly paste it on an <strong>Exchange Management Shell</strong> window (<b>WARNING: this will execute your command as well</b>):

<a href="https://msdnshared.blob.core.windows.net/media/2018/06/clip_image014.png"><img width="854" height="86" title="clip_image014" alt="clip_image014" src="https://msdnshared.blob.core.windows.net/media/2018/06/clip_image014_thumb.png" border="0" /></a>

And that applies for both of the blue boxes containing the <strong>New-DynamicDistributionGroup / Set-DynamicDistributionGroup</strong> commands.

&nbsp;
<a id="Download"><h1>IV- Download link</h1></a>

Of course you can use it to create a base command line, and then add all the options you want to customize your Dynamic Distribution Groups, the tool just generates the basics of a Dynamic Distribution Group creation and only modifies the scope and filter … for example we don’t set any delivery restrictions, owners, etc…, just the basics.

You can <a target="_blank" href="https://gallery.technet.microsoft.com/Exchange-Dynamic-58af31b3" rel="noopener">DOWNLOAD this Excel tool here</a>.

Have a good one !
Cheers
Sam
