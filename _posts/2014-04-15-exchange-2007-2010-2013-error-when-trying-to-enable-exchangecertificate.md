---
layout: post
title: Exchange (2007-2010-2013) – Error when trying to Enable-ExchangeCertificate - PrivateKeyMissing – or – how to ensure that when you import an issued certificate you get the private key generated
date: 2014-04-15 08:24
author: sammykrosoft
comments: true
categories: [Uncategorized]
---
<p></p>  <p>This post is more a reminder on the main rule on what not to do when installing a certificate that you requested using Exchange or IIS. Why this reminder? Because even I forget all the times (I’m not playing with Certificates everyday).</p>  <p>- Cert from the CA HAS to be imported on the SAME server where you made the REQUEST from so that you get the Private Key. E.g. you made the request (using New-ExchangeCertificate OR via IIS) on &lt;SERVER 1&gt;, you sent the CA the cert request, then you HAVE to import the certificate that the CA issued you on &lt;SERVER 1&gt;(using Import-ExchangeCertificate or IIS).</p>  <p>- don’t use MMC to import a certificate you get back from the CA as it won’t associate the Private Key either.</p>  <p></p>  <p>Here is an excellent reminder as well from <strong>DIGICERT.COM</strong>:</p> <font size="3"></font>  <p></p> <font size="3"></font>  <p><font size="3"><b>Error message:</b> &quot;The certificate with thumbprint... was found but is not valid for use with Exchange Server (reason: PrivateKeyMissing).&quot;</font></p> <font size="3"></font>  <p></p> <font size="3"></font>  <p><font size="3"><strong><u>Cause 1: </u></strong>Most common cause of this issue is that a server admin imported the .crt/.cer/.p7b SSL Certificate files through MMC and not through the Exchange command line or IIS where the request was generated. </font></p> <font size="3"></font>  <p><font size="3"><strong><u>Importing stand-alone certificate files through MMC does not associate those files with their private key</u></strong>. SSL Certificates can only be imported via MMC if they have already been installed to their private key and then backed up to a .pfx file.</font></p> <font size="3"></font>  <p><font size="3"><strong><u>Cause 2:</u></strong> An admin correctly imported the certificates to one server but then backed up the certificate files to a .pfx without backing up the private key. </font></p>  <p><font size="3">(------------------------------[Sam’s note]------------------------------- “checkbox “mark private key exportable or when using New-ExchangeCertificate blabla –PrivateKeyExportable:$true] example:</font></p>  <p><font size="3"></font></p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/6521.image_2.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/6521.image_5F00_2.png"><img title="image" style="display:inline;" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/7028.image_thumb.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/7028.image_5F00_thumb.png" width="433" height="52" /></a> </p>  <p><font size="3">or</font></p>  <p><font size="3">New-ExchangeCertificate -GenerateRequest -SubjectName &quot;c=CA, o=CONTOSO, cn=globule.contoso.ca&quot; -DomainName webmail.contoso.ca,sammy.contoso.ca,autodiscover.contoso.ca <strong>-PrivateKeyExportable $true</strong></font></p>  <p><font size="3"></font></p>  <p><font size="3">--------------------------------[end of Sam’s note]----------------------)</font></p>  <p></p>  <p><font size="3"><strong>Source:</strong> </font><a title="http://www.digicert.com/ssl-support/exchange-private-key-missing.htm" href="http://www.digicert.com/ssl-support/exchange-private-key-missing.htm"><font size="3">http://www.digicert.com/ssl-support/exchange-private-key-missing.htm</font></a></p>
