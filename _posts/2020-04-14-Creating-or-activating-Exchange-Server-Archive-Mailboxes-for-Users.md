---
layout: post
author: sammykrosoft
title: Create an Archive for mailboxes on Exchange Server
comments: true
categories: [PowerShell, Exchange]
permalink: /creating-or-activating-exchange-archive-mailboxes.html
---

<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;">
To create an archive for all mailboxes,<br />
</span>
<br />
<br />
<pre class="has-inner-focus" style="-webkit-font-smoothing: auto; border: 1px solid var(--border); box-sizing: inherit; color: #171717; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace !important; font-size: 0.875rem; hyphens: none; line-height: 19px; outline: none; overflow-wrap: normal; overflow: auto; padding: 1rem; tab-size: 4; word-break: normal;" tabindex="0"><code class="lang-PowerShell" data-author-content="Get-Mailbox -Database DB01 -Filter &quot;ArchiveGuid -Eq `$null -AND ArchiveDomain -eq `$null -AND Name -NotLike 'DiscoverySearchMailbox*'&quot; | Enable-Mailbox -Archive
" style="border: 0px; box-sizing: inherit; direction: ltr; display: block; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 1em; line-height: 19px; padding: 0px; position: relative;"><span style="box-sizing: inherit;"><span class="hljs-pscommand" style="box-sizing: inherit; color: #0101fd;">Get-Mailbox</span><span class="hljs-parameter" style="box-sizing: inherit; color: #007d9a;"> -Database</span> DB01<span class="hljs-parameter" style="box-sizing: inherit; color: #007d9a;"> -Filter</span> <span class="hljs-string" style="box-sizing: inherit; color: #a31515;">"ArchiveGuid -Eq `$null -AND ArchiveDomain -eq `$null -AND Name -NotLike 'DiscoverySearchMailbox*'"</span> | <span class="hljs-pscommand" style="box-sizing: inherit; color: #0101fd;">Enable-Mailbox</span><span class="hljs-parameter" style="box-sizing: inherit; color: #007d9a;"> -Archive</span></span></code></pre>
<br />
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;">Link to the full article: <a href="https://docs.microsoft.com/en-us/exchange/policy-and-compliance/in-place-archiving/manage-archives?view=exchserver-2016" target="_blank">Exchange 2016/2019 In-Place archiving</a></span><br />
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"><br /></span>
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;">To create an archive for mailboxes, and set the archive to be hosted on a specific database that we could create to dedicate to archive hosting, we can use the "-ArchiveDatabase &lt;Database_Name&gt;" parameter</span><br />
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"><br /></span>
<br />
<pre class="has-inner-focus" style="border: 1px solid; box-sizing: inherit; color: #171717; font-size: 0.875rem; line-height: 19px; outline: none; overflow-wrap: normal; overflow: auto; padding: 1rem; word-break: normal;" tabindex="0"><code class="lang-PowerShell" data-author-content="Get-Mailbox -Database DB01 -Filter &quot;ArchiveGuid -Eq `$null -AND ArchiveDomain -eq `$null -AND Name -NotLike 'DiscoverySearchMailbox*'&quot; | Enable-Mailbox -Archive
" style="border: 0px; box-sizing: inherit; direction: ltr; display: block; font-size: 1em; line-height: 19px; padding: 0px; position: relative;"><span style="box-sizing: inherit;"><span class="hljs-pscommand" style="box-sizing: inherit; color: #0101fd;">Get-Mailbox</span><span class="hljs-parameter" style="box-sizing: inherit; color: #007d9a;"> -Database</span> DB01<span class="hljs-parameter" style="box-sizing: inherit; color: #007d9a;"> -Filter</span> <span class="hljs-string" style="box-sizing: inherit; color: #a31515;">"ArchiveGuid -Eq `$null -AND ArchiveDomain -eq `$null -AND Name -NotLike 'DiscoverySearchMailbox*'"</span> | <span class="hljs-pscommand" style="box-sizing: inherit; color: #0101fd;">Enable-Mailbox</span><span class="hljs-parameter" style="box-sizing: inherit; color: #007d9a;"> -Archive -ArchiveDatabase A-DB01</span></span></code></pre>
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"></span><br />
<br />
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;">NOTE: ArchiveDatabases need usually less IOPS than Primary Mailbox databases, because we assume that older e-mails will be less often accessed by users. That's why if you decide to host Archive Mailboxes long after having sized and deployed your Exchange OnPrem architecture, we recommend hosting Archive Mailboxes on separate, dedicated databases on other idsks.</span><br />
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"><br /></span>
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;">NOTE2: However, more databases per server mean more RAM and CPU the server will use to manage, replicate these Archive Databases, even if these are not accessed or used as often as the databases hosting the Primary Mailboxes =&gt; I encourage you to plug more databases on your Exchange calculator, just to check the impact of a few more databases on the RAM. Don't worry about storage or IOPs, just focus on CPU and RAM the calculator is estimating the server will use/need.&nbsp;</span><br />
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"><br /></span>
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;">Here's the <a href="https://gallery.technet.microsoft.com/office/Exchange-2013-Server-Role-f8a61780" target="_blank">link to the Exchange 2013/2016 Calculator</a>.</span><br />
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;">For Exchange 2019, the calculator is now included in the Exchange 2019 setup ISO.</span><br />
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"><br /></span>