---
layout: post
title: Windows 2008 R2 â€“ WMI Quota issue caused by either a WMI leak or an application overallocating WMI memory
date: 2013-07-16 11:47
author: sammykrosoft
comments: true
categories: [Uncategorized]
---
<p>&nbsp;<p>I- Default WMI memory quotas for Windows 2008 R2:</p><p>&nbsp;</p><p>Memory Per Host:&nbsp; 536870912    <br>Handles Per Host:&nbsp; 4096     <br> Memory All Hosts:&nbsp; 1073741824     <br>Process Limit All Hosts:&nbsp; 32     <br> Threads Per Host:&nbsp; 256</p><p>&nbsp;</p><p>To check what is the current ones on any Windows 2003 and up servers, you can use the following script, and pipe one or more servers on the function from the following script:</p><p>&nbsp;</p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#Disclaimer : The below script takes a file with server names as pipeline input. </span></p><p><span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#You can write a better function with more time with parameters, error control, etc...&nbsp; </span></p><p>&nbsp;<span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#How to use :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#1- run the script to load the function&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#2- create a text file with server names for which we want to check the WMI quotas&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#3- Launch Get-Content C:tempServerNames.txt | Check-AllWMIQuotas&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p>&nbsp;</p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: blue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Function</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Check-AllWMIQuotas</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> { </span></p><p><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: blue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Begin</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> {&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><b><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Write-Host</span></b><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: maroon; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>"Beginning to process servers from the pipeline"</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: blue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Process</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> {&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#Load the __ProviderHostQuotaConfiguration class from the root namespace&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$objWMI</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>=</span><b><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>get-wmiobject</span></b><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><i><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>-ComputerName</span></i><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$_</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><i><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>-Namespace</span></i><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: maroon; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>root</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> &ndash;</span><i><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Class </span></i><span style='color: maroon; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>__ProviderHostQuotaConfiguration</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>&nbsp; </p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><b><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Write-Host</span></b><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: maroon; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>"----------- Checking Server $_ ------------"</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><b><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Write-host</span></b><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: maroon; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>"Memory Per Host: "</span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$objWMI</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>.MemoryPerHost</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><b><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Write-Host</span></b><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: maroon; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>"Handles Per Host: "</span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$objWMI</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>.HandlesPerHost&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><b><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Write-Host</span></b><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: maroon; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>"Memory All Hosts: "</span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$objWMI</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>.MemoryAllHosts&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><b><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Write-Host</span></b><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: maroon; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>"Process Limit All Hosts: "</span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$objWMI</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>.ProcessLimitAllHosts </span></p><p><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><b><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Write-Host</span></b><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: maroon; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>"Threads Per Host: "</span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$objWMI</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>.ThreadsPerHost&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: blue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>End</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> {&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><b><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Write-Host</span></b><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: maroon; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Finished</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: maroon; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>!</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>}&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p></p><p></p><p>&nbsp;&nbsp; </p><p class="MsoNormal" style="line-height: normal;">&nbsp;</p><p>II- Either monitor WMIPrsve process using Perfmon (ProcessPrivate Bytes of all WMI processes (WmiPrvSE*)) to see if memory is skyrocketting and/or take a dump of the WmiPrvSE process to see which application is using all WMI memory from the allocated quota.</p><p>See <a title="http://blogs.technet.com/b/kevinholman/archive/2010/06/09/wmi-leaks-memory-on-server-2008-r2-monitored-agents.aspx" href="http://blogs.technet.com/b/kevinholman/archive/2010/06/09/wmi-leaks-memory-on-server-2008-r2-monitored-agents.aspx">http://blogs.technet.com/b/kevinholman/archive/2010/06/09/wmi-leaks-memory-on-server-2008-r2-monitored-agents.aspx</a> for some d&eacute;tails.</p><p>&nbsp;</p><p>III- Or if it appears an application needs more WMI memory than allowed by the default quotas, raise the quotas.</p><p>Usually doubling the &ldquo;<strong>Memory Per Host</strong>&rdquo; property is enough. But I usually try first by doubling all properties.</p><p>You can either use WBEMTEST to change the WMI quota, or use Powershell along with GWMI (or Get-WMIObject) to change these on several servers if needed.</p><p>Here is a sample script :</p><p><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'></span></p><p></p><p></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#Disclaimer : The below script takes a file with server names as pipeline input.&nbsp;&nbsp;&nbsp; </span></p><p><span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#You can do a better function with more time with parameters, error control, etc...</span></p><p><span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#How to use :</span></p><p><span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#1- run the script to load the function (copy/paste in a .PS1 file or copy/paste it directly on a Powershell window)</span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#2- create a text file with server names for which we want to change the WMI quotas&nbsp;&nbsp;&nbsp; </span></p><p><span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#3- Launch Get-Content C:tempServerNames.txt | Double-AllWMIQuotas</span></p><p></p><p>&nbsp; <span style='color: blue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Function</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Double-AllWMIQuotas</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> {&nbsp;&nbsp;&nbsp;&nbsp; </span>  </p><p><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: blue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Begin</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> {&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><b><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Write-Host</span></b><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: maroon; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>"Beginning to process servers from the pipeline"</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><b><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Write-Host</span></b><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: maroon; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>"Storing Windows 2008 R2 default"</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$defaultMemoryPerHost</span><span style='color: red; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>=</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>536870912&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$defaultHandlesPerHost</span><span style='color: red; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>=</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>4096&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$defaultMemoryAllHosts</span><span style='color: red; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>=</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>1073741824&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$defaultProcessLimitAllHosts</span><span style='color: red; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>=</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>32&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$defaultThreadsPerHost</span><span style='color: red; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>=</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>256&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span>&nbsp;</p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: blue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>Process</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> {</span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#Load the __ProviderHostQuotaConfiguration class from the root namespace&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$objWMI</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>=</span><b><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>get-wmiobject</span></b><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><i><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>-ComputerName</span></i><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$_</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><i><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>-Namespace</span></i><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: maroon; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>root</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><i><span style='color: cadetblue; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>-Class</span></i><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'> </span><span style='color: maroon; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>__ProviderHostQuotaConfiguration</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#Usually, the below line should be enough, but I recommend to double all values&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$objWMI</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>.MemoryPerHost</span><span style='color: red; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>=</span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$defaultMemoryPerHost</span><span style='color: red; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>*</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>2&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: green; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>#Again, usually the below lines are optional but best practices to be sure we won&rsquo;t have any Out Of Memory error.&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$objWMI</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>.HandlesPerHost</span><span style='color: red; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>=</span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$defaultHandlesPerHost</span><span style='color: red; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>*</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>2&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$objWMI</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>.MemoryAllHosts</span><span style='color: red; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>=</span><span style='color: purple; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>$defaultMemoryAllHosts</span><span style='color: red; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>*</span><span style='color: black; font-family: "Courier New"; font-size: 10pt; mso-ansi-language: en-us;'>2&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"></p></p>

