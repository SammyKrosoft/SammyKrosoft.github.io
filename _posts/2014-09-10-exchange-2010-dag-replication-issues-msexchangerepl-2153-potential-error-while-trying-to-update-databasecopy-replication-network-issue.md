---
layout: post
title: Exchange 2010 DAG replication issues - MSExchangeREPL 2153 + potential error while trying to Update-DatabaseCopy = Replication Network issue
date: 2014-09-10 05:31
author: sammykrosoft
comments: true
categories: [Uncategorized]
---
<p><font size="3"></font><p><font size="3">Adding the above issue on my blog to help me remember as I forgot the commandlet to check for replication network communication issues between members of a DAG (damn limited memory of mine) &ndash; may be valid for Exchange 2013 as well (have to double-check this on my lab when I&rsquo;ll have time between kids, regular work, administrative work, etc, etc)</font></p><p><font size="3"></font></p><p><b><u><font size="3">SYMPTOMS:</font></u></b></p><p><font size="3">If we encounter the following behavior :</font></p><p><font size="3">1- Issues trying to <strong><font face="Lucida console">Update-DatabaseCopy</font></strong> (error message saying that "An error occurred while communicating with server '&lt;Server_Issue&gt;'. Error: Unable to read data from the transport connection: an existing connection was forcibly closed by the remote host.")</font></p><p><font size="3">2- <strong>2153 MSExchangeRepl</strong> errors in the Application Log and NO OTHER RELATED ERRORS</font></p><p><font size="3">3- <strong><font face="Lucida Console">Get-MailboxDatabaseCopyStatus -ConnectionStatus</font></strong> gives the above error on the "IncomingLogCopyingNetwork" parameter.</font></p><p><font size="3" face="Lucida consol">An error occurred while communicating with server '&lt;Server_Name&gt;'. Error: Unable to read data from the transport connection: an existing connection was forcibly closed by the remote host.</font></p><p><b><u><font size="3"></font></u></b></p><p><b><u><font size="3">CAUSE:</font></u></b></p><p><font size="3">Some network error on the Replication network causing the network replication to have issues&hellip;</font></p><p><font size="3"></font></p><p><b><u><font size="3">WORKAROUND:</font></u></b></p><p><font size="3">3 facts to remind first:</font></p><ul>   <li><font size="3">DAGs have 2 defined networks: MAPI Network and Replication Network.</font></li>    <li><font size="3">Replication traffic (Log replication, Heartbeat traffic) goes through the Replication Network</font></li>    <li><font size="3">Exception: Database seeding or re-seeding always goes through the MAPI network.</font></li> </ul><p><font size="3"></font></p><p><font size="3"><b>ACTION</b>: disable replication on "Replication Network" + enable replication on "MAPI Network". then RESTART the MSExchange Replication service.</font></p><p><b><font size="3">To see if it worked:</font></b></p><p><font size="3" face="Lucida Console"><strong>Get-MailboxDatabaseCopyStatus -ConnectionStatus | FT Identity,IncomingLogCopyingNetwork</strong></font></p><p><font size="3">You should see something like "{Server_Name,MAPI-Network}" on the IncomingLogCopyingNetwork column, and no "Error: Unable to read data...." subsequent message.</font></p><p><b><u><font size="3">Raw issue data:</font></u></b></p><p><b><i><font size="3">IncomingLogCopyingNetwork</font></i></b></p><p><font size="3">SERVER_NAME</font></p><p><font size="3">Replication_Network_name</font></p><p><font size="3">An error occurred while communicating with server 'SERVER_NAME'. Error: Unable to read data from the transport connection: an existing connection was forcibly closed by the remote host.</font></p><p><font size="3">Sam.</font></p></p>

