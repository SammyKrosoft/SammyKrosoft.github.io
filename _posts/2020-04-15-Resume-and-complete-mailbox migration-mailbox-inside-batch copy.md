---
layout: post
author: sammykrosoft
title: Resume and complete mailbox migration for one mailbox inside a batch
comments: true
categories: [PowerShell, Exchange, Migration, MoveMailbox, Batch]
permalink: /Resume-and-complete-mailbox migration-mailbox-inside-batch.html
---

<span style="color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;"><span style="background-color: white;">When you have several move requests that were defined in a Batch, and you wish to complete just one of the batches, and not all the batches, you need to set individually the Move Request for that user with the -CompleteAfter parameter. Optionnally you can add the -SuspendWhenReady:$false as well as the -PreventCompletion:$false. These two parameters used to work to be able to complete a move request within a Batch, but recent changes in Exchange Online and Exchange 2016/2019 made them inefficient for just completing a batch. Now you need the -CompleteAfter parameter as well, knowing that this parameter alone enables a Move Request to be completed.</span></span><br />
<span style="color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;"><span style="background-color: white;"><br /></span></span>
<br />
<blockquote class="tr_bq">
<span style="color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;"><span style="background-color: white;"><i>NOTE: after having changed the -CompleteAfter parameter, and/or the -SuspendWhenReadyToComplete:$False and/or the -PreventCompletion:$False, you need to force the Move Request to resume with the "Resume-MoveRequest" cmdlet.</i></span></span></blockquote>
<span style="color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;"><span style="background-color: white;"><br /></span></span>
<br />
<pre class="has-inner-focus" style="border: 1px solid; box-sizing: inherit; font-size: 0.875rem; line-height: 19px; outline: none; overflow-wrap: normal; overflow: auto; padding: 1rem; word-break: normal;" tabindex="0"><code class="lang-PowerShell" data-author-content="Get-Mailbox -Database DB01 -Filter &quot;ArchiveGuid -Eq `$null -AND ArchiveDomain -eq `$null -AND Name -NotLike 'DiscoverySearchMailbox*'&quot; | Enable-Mailbox -Archive
" style="border: 0px; box-sizing: inherit; direction: ltr; display: block; font-size: 1em; line-height: 19px; padding: 0px; position: relative;"><div class="MsoNormal">
<span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9pt;">Get-MoveRequest</span><span style="color: black; font-family: &quot;lucida console&quot;; font-size: 9pt;"> </span><span style="color: navy; font-family: &quot;lucida console&quot;; font-size: 9pt;">-Identity</span><span style="color: black; font-family: &quot;lucida console&quot;; font-size: 9pt;"> </span><span style="color: blueviolet; font-family: &quot;lucida console&quot;; font-size: 9pt;"><a href="mailto:David.Rossi@tbs-sct.gc.ca%7C">Early.Adopter.001@CanadaSam.ca|</a></span><span style="color: black; font-family: &quot;lucida console&quot;; font-size: 9pt;"> </span><span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9pt;">Set-MoveRequest</span><span style="color: black; font-family: &quot;lucida console&quot;; font-size: 9pt;"> </span><span style="color: navy; font-family: &quot;lucida console&quot;; font-size: 9pt;">-SuspendWhenReadyToComplete:</span><span style="color: orangered; font-family: &quot;lucida console&quot;; font-size: 9pt;">$false</span><span style="color: black; font-family: &quot;lucida console&quot;; font-size: 9pt;"> </span><span style="color: navy; font-family: &quot;lucida console&quot;; font-size: 9pt;">-preventCompletion:</span><span style="color: orangered; font-family: &quot;lucida console&quot;; font-size: 9pt;">$false</span><span style="color: black; font-family: &quot;lucida console&quot;; font-size: 9pt;"> </span><span style="color: navy; font-family: &quot;lucida console&quot;; font-size: 9pt;">-CompleteAfter</span><span style="color: black; font-family: &quot;lucida console&quot;; font-size: 9pt;"> </span><span style="font-family: &quot;lucida console&quot;; font-size: 9pt;"><span style="color: purple;">1</span></span></div>
</code></pre>
<br />
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;">Can be simplified as,</span><br />
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"><br /></span>
<br />
<pre class="has-inner-focus" style="border: 1px solid; box-sizing: inherit; font-size: 0.875rem; line-height: 19px; outline: none; overflow-wrap: normal; overflow: auto; padding: 1rem; word-break: normal;" tabindex="0"><code class="lang-PowerShell" data-author-content="Get-Mailbox -Database DB01 -Filter &quot;ArchiveGuid -Eq `$null -AND ArchiveDomain -eq `$null -AND Name -NotLike 'DiscoverySearchMailbox*'&quot; | Enable-Mailbox -Archive
" style="border: 0px; box-sizing: inherit; direction: ltr; display: block; font-size: 1em; line-height: 19px; padding: 0px; position: relative;"><div class="MsoNormal">
<span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9pt;">Get-MoveRequest</span><span style="font-family: &quot;lucida console&quot;; font-size: 9pt;"> </span><span style="color: navy; font-family: &quot;lucida console&quot;; font-size: 9pt;">-Identity</span><span style="font-family: &quot;lucida console&quot;; font-size: 9pt;"> </span><a href="mailto:David.Rossi@tbs-sct.gc.ca%7C" style="color: blueviolet; font-family: &quot;lucida console&quot;; font-size: 12px;">Early.Adopter.001@CanadaSam.ca</a><span style="color: blueviolet; font-family: &quot;lucida console&quot;; font-size: 9pt;"><a href="mailto:David.Rossi@tbs-sct.gc.ca%7C">|</a></span><span style="font-family: &quot;lucida console&quot;; font-size: 9pt;"> </span><span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9pt;">Set-MoveRequest</span><span style="font-family: &quot;lucida console&quot;; font-size: 9pt;"> </span><span style="color: navy; font-family: &quot;lucida console&quot;; font-size: 9pt;">-CompleteAfter</span><span style="font-family: &quot;lucida console&quot;; font-size: 9pt;"> </span><span style="font-family: &quot;lucida console&quot;; font-size: 9pt;"><span style="color: purple;">1</span></span></div>
</code></pre>
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"></span><br />
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"><br /></span>
<span style="color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif;"><span style="background-color: white;">The Set-MoveRequest instruction must be followed by "Resume-MoveRequest" cmdlet:</span></span><br />
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"><br /></span>
<br />
<pre class="has-inner-focus" style="border: 1px solid; box-sizing: inherit; font-size: 0.875rem; line-height: 19px; outline: none; overflow-wrap: normal; overflow: auto; padding: 1rem; word-break: normal;" tabindex="0"><code class="lang-PowerShell" data-author-content="Get-Mailbox -Database DB01 -Filter &quot;ArchiveGuid -Eq `$null -AND ArchiveDomain -eq `$null -AND Name -NotLike 'DiscoverySearchMailbox*'&quot; | Enable-Mailbox -Archive
" style="border: 0px; box-sizing: inherit; direction: ltr; display: block; font-size: 1em; line-height: 19px; padding: 0px; position: relative;"><div class="MsoNormal">
<span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9pt;">Get-MoveRequest</span><span style="font-family: &quot;lucida console&quot;; font-size: 9pt;"> </span><span style="color: navy; font-family: &quot;lucida console&quot;; font-size: 9pt;">-Identity</span><span style="font-family: &quot;lucida console&quot;; font-size: 9pt;"> </span><span style="color: blueviolet; font-family: &quot;lucida console&quot;; font-size: 9pt;"><a href="mailto:David.Rossi@tbs-sct.gc.ca">Early.Adopter.001@CanadaSam.ca</a></span><span style="font-family: &quot;lucida console&quot;; font-size: 9pt;"> </span><span style="color: darkgrey; font-family: &quot;lucida console&quot;; font-size: 9pt;">|</span><span style="font-family: &quot;lucida console&quot;; font-size: 9pt;"> </span><span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9pt;">Resume-MoveRequest</span></div>
</code></pre>
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"><br /></span>
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;">Also note that the -CompleteAfter parameter needs a PowerShell's "Date" format. Setting that CompleteAfter value to "1" means for PowerShell "1st January 0001" - you can test this by running the following command:</span><br />
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"><br /></span>
<br />
<pre class="has-inner-focus" style="border: 1px solid; box-sizing: inherit; line-height: 19px; outline: none; overflow-wrap: normal; overflow: auto; padding: 1rem; word-break: normal;" tabindex="0"><code class="lang-PowerShell" data-author-content="Get-Mailbox -Database DB01 -Filter &quot;ArchiveGuid -Eq `$null -AND ArchiveDomain -eq `$null -AND Name -NotLike 'DiscoverySearchMailbox*'&quot; | Enable-Mailbox -Archive
" style="border: 0px; box-sizing: inherit; direction: ltr; display: block; line-height: 19px; padding: 0px; position: relative;"><div class="MsoNormal">
<span style="color: blue; font-family: &quot;lucida console&quot;;"><span style="font-size: 12px;">PS C:\&gt; get-date 1

Monday, January 1, 0001 12:00:00 AM</span></span></div>
</code></pre>
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"></span><br />
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;">Hence running&nbsp;<span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9pt; white-space: pre;"><code>Set-MoveRequest</code></span><span style="color: black; font-family: &quot;lucida console&quot;; font-size: 9pt; white-space: pre;"> </span><span style="color: navy; font-family: &quot;lucida console&quot;; font-size: 9pt; white-space: pre;">-CompleteAfter</span><span style="color: black; font-family: &quot;lucida console&quot;; font-size: 9pt; white-space: pre;"> </span><span style="color: black; font-family: &quot;lucida console&quot;; font-size: 9pt; white-space: pre;"><span style="color: purple;">1</span></span></span>&nbsp;<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;">will set the Move Request to complete after 1st January 0001, which is anytime (as we're already in 2020 AD)</span><br />
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"><br /></span>
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;">In summary, get the move request you want to complete from the Batch, set the completion after date </span><span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9pt; white-space: pre;">Set-MoveRequest &lt;e-mail address&gt;</span><span style="font-family: &quot;lucida console&quot;; font-size: 9pt; white-space: pre;"> </span><span style="color: navy; font-family: &quot;lucida console&quot;; font-size: 9pt; white-space: pre;">-CompleteAfter</span><span style="font-family: &quot;lucida console&quot;; font-size: 9pt; white-space: pre;"> </span><span style="font-family: &quot;lucida console&quot;; font-size: 9pt; white-space: pre;"><span style="color: purple;">1</span></span><span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;">&nbsp;and then force-resume the move request </span><span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 12px; white-space: pre;">Resume-MoveRequest &lt;e-mail address&gt;</span><span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;">&nbsp;and voil√† !</span><br />
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"><br /></span>
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"><br /></span>
<span style="background-color: white; color: #171717; font-family: &quot;segoe ui&quot; , &quot;segoeui&quot; , &quot;segoe wp&quot; , &quot;helvetica neue&quot; , &quot;helvetica&quot; , &quot;tahoma&quot; , &quot;arial&quot; , sans-serif; font-size: 16px;"><br /></span>