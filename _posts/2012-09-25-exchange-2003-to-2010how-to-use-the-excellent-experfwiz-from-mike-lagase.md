---
layout: post
title: Exchange 2003 to 2010–How to use the excellent ExPerfWiz from Mike Lagase
date: 2012-09-25 13:16
author: sammykrosoft
comments: true
categories: [Uncategorized]
---
<p>&#160;</p>  <p>For Exchange 2003, the Perfwiz is an HTML configuration file, that can be taken from <a href="http://blogs.technet.com/b/mikelag/archive/2009/02/02/updated-exchange-2003-perfwiz.aspx">Mike’s blog article specific for Exchange 2003</a>.</p>  <p>For Exchange 2007 and 2010, just download the script from the following link :</p>  <p><a title="http://experfwiz.codeplex.com/" href="http://experfwiz.codeplex.com/">http://experfwiz.codeplex.com/</a></p>  <p>It will set up performance counters from you and automatically select the best performance counters based on the roles of you Exchange servers !</p>  <h4>Examples from <a href="http://blogs.technet.com/b/mikelag/archive/2010/07/09/exchange-2007-2010-performance-data-collection-script.aspx">Mike’s blog</a> :</h4>  <p>Remotely configure performance data collection on HUBServer between 2 dates or 2 hours (3rd October 7:00AM and 3rd October 11:00AM) with a collection interval of 15 seconds    <br /><b><i>.\experfwiz.ps1 -<b><i>server HUBServerName </i></b>-interval 15 -begin 10/03/2012 07:00:00&quot; -end &quot;10/03/2012 11:00:00&quot; -filepath D:\Logs</i></b></p>  <p>Set duration to 4 hours, change interval to collect data every 5 seconds and set Data location to d:\Logs    <br /><b><i>.\experfwiz.ps1 -duration 04:00:00 -interval 5 -filepath D:\Logs</i></b>     <br />    <br />Add threads to the collection set     <br /><b><i>.\experfwiz.ps1 –threads</i></b>     <br />    <br />Stop Data collection     <br /><b><i>.\experfwiz.ps1 –stop</i></b>     <br />    <br />Create collection for all counters/instances.     <br /><b><i>.\experfwiz.ps1 –full</i></b></p>  <p><strong><em></em></strong></p>  <p>Example on my own server :</p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/2570.image_2.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/2570.image_5F00_2.png"><img style="background-image: none; border-right-width: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/4237.image_thumb.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/4237.image_5F00_thumb.png" width="244" height="121" /></a></p>
