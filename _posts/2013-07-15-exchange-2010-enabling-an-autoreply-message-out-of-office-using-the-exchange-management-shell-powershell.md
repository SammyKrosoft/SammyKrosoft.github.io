---
layout: post
title: Exchange 2010 - Enabling an Autoreply Message (Out Of Office) using the Exchange Management Shell (Powershell)
date: 2013-07-15 21:51
author: sammykrosoft
comments: true
categories: [Uncategorized]
---
<p>&#160;</p>  <p>Here is how to test it on a user first.</p>  <p>1&gt; Using powershell, do a <font face="Courier new">$objMailbox = Get-Mailbox Some_Test_User</font> to get the user we will assign the Out Of Office to.</p>  <p>2&gt; Now define your text (best is to do it in HTML) and store it on 2 variables $InternalMsg and $ExternalMsg like in the example below:</p>  <p>$InternalMsg = &quot;-- Internal Message -- &lt;BR&gt;&lt;BR&gt;Hi, &lt;BR&gt;&lt;BR&gt;I am not available until next Monday.&lt;BR&gt;&lt;BR&gt;For any emergency, please contact my backup John at 613-555-6789.&lt;BR&gt;&lt;BR&gt;Jack Doe&quot;</p>  <p>$ExternalMsg = &quot;-- External Message -- &lt;BR&gt;&lt;BR&gt;Hi, &lt;BR&gt;&lt;BR&gt;I am not available until next Monday.&lt;BR&gt;&lt;BR&gt;For any emergency, please contact my backup John at 613-555-6789.&lt;BR&gt;&lt;BR&gt;Jack Doe&quot;</p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/1321.clip_image001[4].png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/1321.clip_5F00_image001_5B00_4_5D00_.png"><img title="clip_image001[4]" style="display: inline;" border="0" alt="clip_image001[4]" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/0247.clip_image001[4]_thumb.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/0247.clip_5F00_image001_5B00_4_5D005F00_thumb.png" width="244" height="29" /></a></p>  <p>3&gt; Now, it’s time to witness the effect of the OOF application on the user’s mailbox. </p>  <p>Open either an Outlook or an Outlook Web App session and check the Out Of Office status, which should be deactivated, with no messages configured (greyed anyways) or some older messages configured :</p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/4478.clip_image002_2.jpg" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/4478.clip_5F00_image002_5F00_2.jpg"><img title="clip_image002" style="display: inline;" border="0" alt="clip_image002" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/8032.clip_image002_thumb.jpg" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/8032.clip_5F00_image002_5F00_thumb.jpg" width="244" height="124" /></a></p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/3833.clip_image003[4].jpg" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/3833.clip_5F00_image003_5B00_4_5D00_.jpg"><img title="clip_image003[4]" style="display: inline;" border="0" alt="clip_image003[4]" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/5482.clip_image003[4]_thumb.jpg" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/5482.clip_5F00_image003_5B00_4_5D005F00_thumb.jpg" width="244" height="61" /></a></p>  <p>4&gt; Launch the commandlet against the test user by piping the $ObjMailbox variable we set above with the test user mailbox (UserTest1 in my example):</p>  <p>$objMailbox | Set-MailboxAutoReplyConfiguration -AutoReplyState enabled -ExternalAudience all -InternalMessage $InternalMsg -ExternalMessage $ExternalMsg</p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/1526.clip_image004_2.jpg" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/1526.clip_5F00_image004_5F00_2.jpg"><img title="clip_image004" style="display: inline;" border="0" alt="clip_image004" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/0552.clip_image004_thumb.jpg" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/0552.clip_5F00_image004_5F00_thumb.jpg" width="244" height="19" /></a></p>  <p>5&gt; Check in Outlook or OWA that the message is now set to “Send automatic replies” and also that we have the correct message as defined in the script, for both internal and External OOF messages :</p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/2046.clip_image005[4].jpg" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/2046.clip_5F00_image005_5B00_4_5D00_.jpg"><img title="clip_image005[4]" style="display: inline;" border="0" alt="clip_image005[4]" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/7433.clip_image005[4]_thumb.jpg" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/7433.clip_5F00_image005_5B00_4_5D005F00_thumb.jpg" width="244" height="124" /></a></p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/6862.clip_image006_2.jpg" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/6862.clip_5F00_image006_5F00_2.jpg"><img title="clip_image006" style="display: inline;" border="0" alt="clip_image006" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/8358.clip_image006_thumb.jpg" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/8358.clip_5F00_image006_5F00_thumb.jpg" width="244" height="69" /></a></p>  <p>Once you verified it, to apply the OOF to the remainder of the mailboxes, or in my example to all mailboxes containing the string “User”, define your $objMailbox variable with a Get-Mailbox *<b>User</b>* for example, and reapply the powershell command:</p>  <p>$objMailbox | Set-MailboxAutoReplyConfiguration -AutoReplyState enabled -ExternalAudience all -InternalMessage $InternalMsg -ExternalMessage $ExternalMsg</p>  <p>Note: To deactivate the OOF using Powershell on one or more users (depending how many mailboxes you have on the $ObjMailbox variable above), user the following command:</p>  <p>$objMailbox | Set-MailboxAutoReplyConfiguration -AutoReplyState disabled</p>
