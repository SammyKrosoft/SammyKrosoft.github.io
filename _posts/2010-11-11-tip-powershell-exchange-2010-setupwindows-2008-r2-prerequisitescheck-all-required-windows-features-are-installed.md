---
layout: post
title: Tip Powershell & Exchange 2010 Setup–Windows 2008 R2 prerequisites–Check all required Windows Features are installed
date: 2010-11-11 08:04
author: sammykrosoft
comments: true
categories: [Uncategorized]
---
<ol><font size="3">&nbsp;</font>    <h1><font size="3"><strong>I- Ce post concerne l&rsquo;installation de Exchange 2010 avec les r&ocirc;les CAS, HUB,MAILBOX install&eacute;s sur&nbsp; un serveur Windows 2008 R2</strong></font></h1>    <p><font size="3">Pour les informations compl&egrave;tes sur les pr&eacute;requis pour les autres syst&egrave;mes d&rsquo;exploitation, voir l&rsquo;aide en ligne de Exchange 2010 &agrave; l&rsquo;adresse :</font></p>    <p><a title="http://technet.microsoft.com/en-us/library/bb691354.aspx" href="http://technet.microsoft.com/en-us/library/bb691354.aspx"><font size="3">http://technet.microsoft.com/en-us/library/bb691354.aspx</font></a></p>   <font size="3"></font>    <p><font size="3">Nous allons nous focaliser sur la partie de l&rsquo;activation des additifs de Windows 2008 R2 pour l&rsquo;installation d&rsquo;un serveur Exchange 2010 h&eacute;bergeant les r&ocirc;les CAS, HUB et MAILBOX, la partie :</font></p>   <font size="3"></font><font size="3"></font>    <ol></ol>    <li>     <p><font size="3"><font face="Courier New"><span style="color: #0000ff">Import-Module</span> <span style="color: #8a2be2">ServerManager</span></font></font></p>   </li>    <li>     <p><font size="3"><font face="Courier New"><span style="color: #0000ff">Add-WindowsFeature</span> <span style="color: #8a2be2">NET-Framework</span><span style="color: #a9a9a9">,</span><span style="color: #8a2be2">RSAT-ADDS</span><span style="color: #a9a9a9">,</span><span style="color: #8a2be2">Web-Server</span><span style="color: #a9a9a9">,</span><span style="color: #8a2be2">Web-Basic-Auth</span><span style="color: #a9a9a9">,</span><span style="color: #8a2be2">Web-Windows-Auth</span><span style="color: #a9a9a9">,</span><span style="color: #8a2be2">Web-Metabase</span><span style="color: #a9a9a9">,</span><span style="color: #8a2be2">Web-Net-Ext</span><span style="color: #a9a9a9">,</span><span style="color: #8a2be2">Web-Lgcy-Mgmt-Console</span><span style="color: #a9a9a9">,</span><span style="color: #8a2be2">WAS-Process-Model</span><span style="color: #a9a9a9">,</span><span style="color: #8a2be2">RSAT-Web-Server</span><span style="color: #a9a9a9">,</span><span style="color: #8a2be2">Web-ISAPI-Ext</span><span style="color: #a9a9a9">,</span><span style="color: #8a2be2">Web-Digest-Auth</span><span style="color: #a9a9a9">,</span><span style="color: #8a2be2">Web-Dyn-Compression</span><span style="color: #a9a9a9">,</span><span style="color: #8a2be2">NET-HTTP-Activation</span><span style="color: #a9a9a9">,</span><span style="color: #8a2be2">RPC-Over-HTTP-Proxy</span> <span style="color: #000080">&ndash;Restart</span></font></font></p>        <hr></li>    <ol></ol><font size="3" face="Times New Roman"></font><font size="3" face="Times New Roman"></font><font size="3" face="Arial"><strong></strong></font><h1><font size="3" face="Arial"><strong>II- V&eacute;rifiez que les pr&eacute;requis sont bien install&eacute;s.</strong></font></h1><p><font size="3" face="Arial">- Pour cela, nous allons cr&eacute;er une variable PowerShell contenant la liste de tous les services cens&eacute;s &ecirc;tre install&eacute;s sur le serveur, comme suit :</font></p><p><font size="3"><font face="Courier New"><span style="color: #ff4500">$WinFeat</span><span style="color: #a9a9a9">=</span><span style="color: #8b0000">"Net-Framework"</span><span style="color: #a9a9a9">,</span><span style="color: #8b0000">"RSAT-ADDS"</span><span style="color: #a9a9a9">,</span><span style="color: #8b0000">"Web-Server"</span><span style="color: #a9a9a9">,</span><span style="color: #8b0000">"Web-Basic-Auth"</span><span style="color: #a9a9a9">,</span><span style="color: #8b0000">"Web-Windows-Auth"</span><span style="color: #a9a9a9">,</span><span style="color: #8b0000">"Web-Metabase"</span><span style="color: #a9a9a9">,</span><span style="color: #8b0000">"Web-Net-Ext"</span><span style="color: #a9a9a9">,</span><span style="color: #8b0000">"Web-Lgcy-Mgmt-Console"</span><span style="color: #a9a9a9">,</span><span style="color: #8b0000">"WAS-Process-Model"</span><span style="color: #a9a9a9">,</span><span style="color: #8b0000">"RSAT-Web-Server"</span><span style="color: #a9a9a9">,</span><span style="color: #8b0000">"Web-ISAPI-Ext"</span><span style="color: #a9a9a9">,</span><span style="color: #8b0000">"Web-Digest-Auth"</span><span style="color: #a9a9a9">,</span><span style="color: #8b0000">"Web-Dyn-Compression"</span><span style="color: #a9a9a9">,</span><span style="color: #8b0000">"NET-HTTP-Activation"</span><span style="color: #a9a9a9">,</span><span style="color: #8b0000">"RPC-Over-HTTP-Proxy"</span></font></font></p><p><font size="3">Cette variable sera donc automatiquement typ&eacute;e comme &ldquo;tableau&rdquo; ou &ldquo;array&rdquo;</font></p><font size="3"></font><p><font size="3">- Puis, pour chaque objet de la variable, nous allons lister le statut de l&rsquo;installation.</font></p><p><font size="3"><em>Note : le module &ldquo;ServerManager&rdquo; doit &ecirc;tre charg&eacute; &agrave; chaque nouvelle session PowerShell. Si vous voulez que le module &ldquo;ServerManager&rdquo; soit charg&eacute; &agrave; chaque d&eacute;marrage de session PowerShell, ajoutez la ligne &ldquo;Import-Module&rdquo; au niveau de votre profil PowerShell. </em></font></p><p><font size="3"><em>Visitez la page </em><a title="http://msdn.microsoft.com/en-us/library/bb613488(VS.85).aspx" href="http://msdn.microsoft.com/en-us/library/bb613488(VS.85).aspx"><em>http://msdn.microsoft.com/en-us/library/bb613488(VS.85).aspx</em></a><em> pour plus d&rsquo;informations sur les profils PowerShell</em></font></p><font size="3"></font><p><font size="3"><font face="Courier New"><span style="color: #ff4500"></span></font></font></p><p><font size="3"><font face="Courier New"><span style="color: #ff4500">$winFeat</span> <span style="color: #a9a9a9">|</span> <span style="color: #0000ff">ForEach-Object</span> <span style="color: #000000">{</span><span style="color: #0000ff">get-WindowsFeature</span> <span style="color: #000080">-Name</span> <span style="color: #ff4500">$_</span><span style="color: #000000">}</span></font></font></p><font size="3"></font><p><font face="Courier New">Display Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Name </font></p><font face="Courier New">     <p>------------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ---- </p>      <p>[X] .NET Framework 3.5.1 Features&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NET-Framework </p>      <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [X] AD DS Tools&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RSAT-ADDS </p>      <p>[X] Web Server (IIS)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Web-Server </p>      <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [X] Basic Authentication&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Web-Basic-Auth </p>      <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [X] Windows Authentication&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Web-Windows-Auth </p>      <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [X] IIS 6 Metabase Compatibility&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Web-Metabase </p>      <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [X] .NET Extensibility&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Web-Net-Ext </p>      <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [X] IIS 6 Management Console&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Web-Lgcy-Mgmt-Console </p>      <p>&nbsp;&nbsp;&nbsp; [X] Process Model&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WAS-Process-Model </p>      <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [X] Web Server (IIS) Tools&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RSAT-Web-Server </p>      <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [X] ISAPI Extensions&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Web-ISAPI-Ext </p>      <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [X] Digest Authentication&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Web-Digest-Auth </p>      <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [X] Dynamic Content Compression&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Web-Dyn-Compression </p>      <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [X] HTTP Activation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NET-HTTP-Activation </p>      <p><font face="Courier New">[X] RPC over HTTP Proxy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RPC-over-HTTP-Proxy</font></p>   </font><font size="3"></font><font size="3"><strong></strong></font><font size="3"><strong></strong></font><hr><h1><font size="3"><strong>III- Deuxi&egrave;me V&eacute;rification : v&eacute;rifier le nombre de services install&eacute;s !</strong></font></h1><p><font size="3">Pour v&eacute;rifier que tous les objets sont bien list&eacute;s, utilisez la propri&eacute;t&eacute;s de comptage des objets : <strong>(Nom de l&rsquo;objet).Count</strong></font></p><p><font size="3">Utilisez cette propri&eacute;t&eacute; pour la variable &ldquo;Array&rdquo; $WinFeat de notre exemple, ET AUSSI pour le nombre de r&eacute;sultats de la commande ForEach comme suite :</font></p><p><font size="3"><font face="Courier New"><span style="color: #000000">(</span><span style="color: #ff4500">$WinFeat</span><span style="color: #000000">)</span><span style="color: #a9a9a9">.</span><span style="color: #000000">count</span></font></font></p><p><font size="3" face="Courier New">R&eacute;sultat : 15</font></p><p><font size="3"><font face="Courier New"><span style="color: #000000">(</span><span style="color: #ff4500">$winFeat</span> <span style="color: #a9a9a9">|</span> <span style="color: #0000ff">ForEach-Object</span> <span style="color: #000000">{</span><span style="color: #0000ff">get-WindowsFeature</span> <span style="color: #000080">-Name</span> <span style="color: #ff4500">$_</span><span style="color: #000000">}</span><span style="color: #000000">)</span><span style="color: #a9a9a9">.</span><span style="color: #000000">count</span></font></font></p><p><font size="3" face="Courier New">R&eacute;sultat : 15</font></p><p><font size="3" face="Courier New"></font></p><font size="3"></font><font size="3"></font><font size="3"></font><p><font size="3"><strong>Pourquoi ?</strong> Simplement pour v&eacute;rifier qu&rsquo;aucune erreur de frappe n&rsquo;a &eacute;t&eacute; commise au niveau de la liste des additions Windows de la variable $WinFeat. Si une erreur de frappe est commise (exemple j&rsquo;ai fait l&rsquo;erreur au niveau du dernier nom &ldquo;RPC-Over-HTTP-Prox<strong><u>u</u></strong>&rdquo;, la commande ForEach-Object ne m&rsquo;a retourn&eacute; que 14 objets &hellip;) cette astuce nous permettra donc d&rsquo;&eacute;viter les erreurs b&ecirc;tes au niveau de l&rsquo;activation des pr&eacute;requis de Windows pour Exchange 2010 !</font></p><p><font size="3">CQFD.</font></p><font size="3"></font><p><font size="3">Have fun !</font></p></ol>

