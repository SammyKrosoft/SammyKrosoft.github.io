---
layout: post
title: Exchange Server 2010–Move Mailbox Request - why the move requests stay in the “Move Request” list after the move ?
date: 2011-06-10 08:26
author: sammykrosoft
comments: true
categories: [Uncategorized]
---
<p>&#160;</p>  <p>When you move a mailbox, in my example between an Exchange Server 2010 and Exchange Server 2003 – yes in this order, it’s a back-move, just to show it is possible to do so – after the move is complete, the Move Request stays in the “Move Request” queue, with a “Completed” status.</p>  <p>But if you want to move again this mailbox, you will have to clear the “Completed” move request first.</p>  <p>The records stay there just to keep track of the Move Mailbox statistics. When you remove the Move Request, the Move Mailbox statistics on the Mailbox are gone.</p>  <p>Here is the demonstration :</p>  <p>1/ Mailbox alias : MarcD</p>  <p>Mailbox full name : Marc Dupond</p>  <p>Mailbox location : Exchange 2010 SP1 Server (2008SRV1)</p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/7288.image_2.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/7288.image_5F00_2.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/5516.image_thumb.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/5516.image_5F00_thumb.png" width="244" height="210" /></a></p>  <p>&#160;</p>  <p>2/ Move MarcD from the Exchange 2010 server to the Exchange 2003 server (<strong>New Local Move Request…</strong>)</p>  <p>&gt; Console :</p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/2474.image_4.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/2474.image_5F00_4.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/7673.image_thumb_1.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/7673.image_5F00_thumb_5F00_1.png" width="244" height="226" /></a></p>  <p>then:</p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/3365.image_6.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/3365.image_5F00_6.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/4540.image_thumb_2.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/4540.image_5F00_thumb_5F00_2.png" width="244" height="213" /></a></p>  <p>(note the target mailbox database is my Exchange 2003 “E2K3” server)</p>  <p>next screen :</p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/1803.image_8.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/1803.image_5F00_8.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/5025.image_thumb_3.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/5025.image_5F00_thumb_5F00_3.png" width="244" height="213" /></a></p>  <p>last and success screen :</p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/6507.image_10.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/6507.image_5F00_10.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/4540.image_thumb_4.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/4540.image_5F00_thumb_5F00_4.png" width="244" height="213" /></a></p>    <p>&gt; Powershell :</p>  <p><strong>'CONTOSO.COM/Users/Marc Dupond' | New-MoveRequest -TargetDatabase 'E2K3\First Storage Group\Mailbox Store (E2K3)'</strong></p>  <p>&#160;</p>  <p>3/ Note the Completed Move Request in the EMC :</p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/5025.image_12.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/5025.image_5F00_12.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/5444.image_thumb_5.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/5444.image_5F00_thumb_5F00_5.png" width="513" height="110" /></a></p>  <p>4/ See the Move statistics (either in the Get-MoveRequest that will show the same info as the EMC or in the Mailbox properties directly)</p>  <p><strong>[PS] C:\Windows\system32&gt;Get-MoveRequest | fl</strong></p>  <p>   <br />RunspaceId&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : acb067c3-155b-4140-b43a-edc0048a5dc6    <br />ExchangeGuid&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : ba53f864-3fba-4169-ad64-203d33f934ab    <br />SourceDatabase&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : DB04    <br />TargetDatabase&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : E2K3\First Storage Group\Mailbox Store (E2K3)    <br />SourceArchiveDatabase&#160;&#160;&#160;&#160;&#160; :    <br />TargetArchiveDatabase&#160;&#160;&#160;&#160;&#160; :    <br />Flags&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : IntraOrg, Push, Offline    <br />RemoteHostName&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :    <br />BatchName&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :    <br />Status&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : Completed    <br />RequestStyle&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : IntraOrg    <br />Direction&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : Push    <br />IsOffline&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : True    <br />Protect&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : False    <br />Suspend&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : False    <br />SuspendWhenReadyToComplete : False    <br />Alias&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : MarcD    <br />DisplayName&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : Marc Dupond    <br />ExternalDirectoryObjectId&#160; :    <br />LastExchangeChangedTime&#160;&#160;&#160; :    <br />RecipientType&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : UserMailbox    <br />RecipientTypeDetails&#160;&#160;&#160;&#160;&#160;&#160; : LegacyMailbox    <br />IsValid&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : True    <br />ExchangeVersion&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : 0.0 (6.5.6500.0)    <br />Name&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : Marc Dupond    <br />DistinguishedName&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : CN=Marc Dupond,CN=Users,DC=CONTOSO,DC=COM    <br />Identity&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : CONTOSO.COM/Users/Marc Dupond    <br />Guid&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : 68003223-28d0-4f73-95e3-8ff1355747ba    <br />OrganizationId&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :    <br />OriginatingServer&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : dc2003.CONTOSO.COM</p>  <p>&#160;</p>        <p><strong>[PS] C:\Windows\system32&gt;Get-Mailbox MarcD&#160; |FL Identity,*Mailbox*</strong></p>  <p>   <br />Identity&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : CONTOSO.COM/Users/Marc Dupond    <br />DeliverToMailboxAndForward : False    <br />ManagedFolderMailboxPolicy :    <br />IsMailboxEnabled&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : True    <br />MailboxPlan&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :    <br />MailboxMoveTargetMDB&#160;&#160;&#160;&#160;&#160;&#160; : E2K3\First Storage Group\Mailbox Store (E2K3)    <br />MailboxMoveSourceMDB&#160;&#160;&#160;&#160;&#160;&#160; : DB04    <br />MailboxMoveFlags&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : IntraOrg, Push, Offline    <br />MailboxMoveRemoteHostName&#160; :    <br />MailboxMoveBatchName&#160;&#160;&#160;&#160;&#160;&#160; :    <br />MailboxMoveStatus&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : Completed    <br />WhenMailboxCreated&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : 6/10/2011 10:16:14 AM    <br />ArbitrationMailbox&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :</p>  <p>&#160;</p>  <p>5/ We remove the Move Request (if you don’t, you won’t be able to move the mailbox again, either on an other server or even on an other database on the same server) :</p>  <p>&gt; Console:</p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/5025.image_14.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/5025.image_5F00_14.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/7587.image_thumb_6.png" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/7587.image_5F00_thumb_5F00_6.png" width="244" height="66" /></a></p>  <p>&gt; Powershell :</p>  <p><strong>'CONTOSO.COM/Users/Marc Dupond' | Remove-MoveRequest</strong></p>  <p>6/ Obviously the Get-Moverequest will then return an empty list (or a list without the MarcD user move stats), but also the Mailbox properties from MarcD won’t be there anymore !</p>  <p><strong>[PS] C:\Windows\system32&gt;Get-Mailbox MarcD&#160; |FL Identity,*Mailbox*</strong></p>  <p>   <br />Identity&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : CONTOSO.COM/Users/Marc Dupond    <br />DeliverToMailboxAndForward : False    <br />ManagedFolderMailboxPolicy :    <br />IsMailboxEnabled&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : True    <br />MailboxPlan&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :    <br />MailboxMoveTargetMDB&#160;&#160;&#160;&#160;&#160;&#160; :    <br />MailboxMoveSourceMDB&#160;&#160;&#160;&#160;&#160;&#160; :    <br />MailboxMoveFlags&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : None    <br />MailboxMoveRemoteHostName&#160; :    <br />MailboxMoveBatchName&#160;&#160;&#160;&#160;&#160;&#160; :    <br />MailboxMoveStatus&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : None    <br />WhenMailboxCreated&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : 6/10/2011 10:16:14 AM    <br />ArbitrationMailbox&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :</p>  <p>&#160;</p>  <p>=&gt; We now understand why the Move Mailbox request stay inside : mainly to keep track of the Move mailbox statistics, especially useful for bulk and large migrations, and also to keep an history, and eventually export this history onto a text or CSV history file.</p>  <p>The fact we cannot move Mailboxes for existing status request even if they are Completed, guess it’s to be sure we keep track of the last status before cleaning those stats… any thoughts are welcome !</p>  <p>&#160;</p>  <p>Happy testings, </p>  <p>Sam</p>
