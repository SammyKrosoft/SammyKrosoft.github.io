---
layout: post
title: Exchange 2010/2013 – How to give permissions to users to manage Universal Security Distribution Lists (must use RBAC)
date: 2013-10-01 06:44
author: sammykrosoft
comments: true
categories: [Uncategorized]
---
<p>Users on Exchange 201x who try to update or create a Distribution List may get the following error message:</p> <p>"Changes to the public group membership cannot be saved. You do not have sufficient permission to perform this operation on this object.”</p> <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/8156.image_2.png"><img title="image" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/8816.image_thumb.png" width="345" height="118"></a></p> <p>&nbsp;</p> <p>Usually, it’s because they don’t have the permissions (reminder: RBAC only for Exchange 2010 users) to create or modify security groups).</p> <p>Depending if you wish to assign the permissions to manage Distribution Groups to Administrators or to users, you will either create, customize or assign the <span>“<font color="#9b00d3">Security group creation and membership</font>” </span> RBAC role&nbsp; or the "<font color="#9b00d3">MyDistributionGroups</font>" role.</p> <p>&nbsp;</p> <p><strong><font size="4">I- For users to enable distribution group owners to add/remove users from their distribution groups:</font></strong></p> <p>Easiest way to achieve this is by using a script that automates the steps to enable group owners to manage their distribution groups (create, delete groups, add, remove group members):</p> <p><strong>Description</strong></p> <p>This script does the following:</p> <ol> <li>Creates a <strong>new RBAC role</strong> that is a <strong>child of the MyDistributionGroups Role</strong>  <li><strong>Removes</strong> the cmdlets <strong>remove-distributiongroup</strong> and <strong>new-distributiongroup</strong> from the new role that was just created.  <li>Assigns the new role to the <strong>Default Role Assignment Policy</strong> </li></ol> <p>When complete your users will be able to manage distribution groups but not create or remove them.</p> <p><strong>Link to the script</strong></p> <p><em><a href="https://gallery.technet.microsoft.com/scriptcenter/8c22734a-b237-4bba-ada5-74a49321f159">https://gallery.technet.microsoft.com/scriptcenter/8c22734a-b237-4bba-ada5-74a49321f159</a></em></p> <p><strong>Syntax</strong> :</p> <p><font color="#9b00d3" face="Lucida Console">Manage-GroupManagementRole -CreateGroup -RemoveGroup</font></p> <p>&nbsp;</p> <p><strong><font size="4">II- For helpdesk or "Distribution Group administrators"</font></strong></p> <p>To assign these permissions to a security group in which you add users (<strong>recommended</strong>) or to a single user:</p> <p>1 – First create a security group</p> <p>2 – All the DL owners should be member of this group ( This way you do not have to assign permissions to individual users, it will be easier to manage permissions Only for the required users, )</p> <p>3 – Assign permissions to security group (<strong>recommended</strong>)</p> <ul> <li><font color="#9b00d3"><span style="font-family: courier new">New-managementroleassignment –role “Security group creation and membership” –securitygroup “DL Owners”</span> </font></li></ul> <p>or to assign the roles directly to user</p> <ul> <li><font color="#9b00d3"><span style="font-family: courier new">New-managementroleassignment –role “Security group creation and membership” –User “username”</span> </font></li></ul> <p>5 – Add all the users who needs to manage DL’s to the security group</p> <p>6 – Wait for AD Replication</p> <p>7 – now users will be able to manage Mail enabled Security DL using outlook</p> <p>8 – Any helpdesk users can use Exchange management shell and manage DL membership</p> <p>9 - logout and login to their outlooks and try to change the Security group membership</p> <p>&nbsp;</p> <p>&nbsp;</p> <p>NOTE : If you configured Outlook 2010 or earlier to directly use a GC (using the “ClosestGC” or the “DS Server” registry key) as per <a href="http://support.microsoft.com/kb/319206">http://support.microsoft.com/kb/319206</a> , users won’t be able to manage DL memberships or creation as this will bypass RBAC check and use AD permissions instead – it’s not recommended you give users direct AD permissions – Also remember that the registry keys described in the above article (KB 319206) works, but is NOT SUPPORTED when mailboxes are in Exchange 2010/2013 (one example why is the bypass of RBAC permissions for AD related operations like DL management). So please only use these for troubleshooting purposes.</p> <p>&nbsp;</p> <p>Sam.</p>
