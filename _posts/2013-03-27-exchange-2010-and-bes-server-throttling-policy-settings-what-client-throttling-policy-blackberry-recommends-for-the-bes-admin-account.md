---
layout: post
title: Exchange 2010 and BES server Throttling Policy settings - What Client Throttling Policy Blackberry recommends for the BES Admin Account.
date: 2013-03-27 12:10
author: sammykrosoft
comments: true
categories: [Uncategorized]
---
<p><span style="text-decoration:underline;"><strong>To avoid BES connection latencies and connectivity issues, the Client Access Throttling Policy recommended by RIM is as follows:</strong></span><p></p><p>By default, Microsoft&reg; Exchange 2010 uses client throttling policies to track the bandwidth that each Microsoft Exchange user consumes and enforce bandwidth limits as necessary. The policies affect the performance of the BlackBerry&reg; Enterprise Server, so you should turn off client throttling for the Windows&reg; account that has a Microsoft Exchange mailbox.</p><p>1. On a computer that hosts the Microsoft Exchange Management Shell, open the Microsoft Exchange Management Shell.</p><p></p><p>2. Type <b>New-ThrottlingPolicy BESPolicy</b></p><p><b>&nbsp;</b></p><p>3. Type the following command:</p><p></p><p><b>Set-ThrottlingPolicy BESPolicy -RCAMaxConcurrency $null -RCAPercentTimeInAD $null -</b><b>RCAPercentTimeInCAS $null -RCAPercentTimeInMailboxRPC $null -EWSMaxConcurrency $null -</b></p><p><b>EWSPercentTimeInAD $null -EWSPercentTimeInCAS $null -EWSPercentTimeInMailboxRPC $null -</b><b>EWSMaxSubscriptions $null -EWSFastSearchTimeoutInSeconds $null -EWSFindCountLimit $null</b></p><p><b>&nbsp;</b></p><p>4. Type <b>Set-Mailbox "BESAdmin" -ThrottlingPolicy BESPolicy</b></p><p></p><p>The <strong>MaxSessionsPerUser</strong> value in the Address Book Service is limited by the <strong>RCAMaxConcurrency</strong> value, which also controls the number of MAPI connections allowed by the service account.</p><p></p><p>The <strong><em>RCAMaxConcurrency</em> </strong>parameter specifies how many concurrent connections an RPC Client Access user can have against a server running Exchange 2010 at one time. A connection is held from the moment a request is received until the connection is closed or the connection is otherwise disconnected (for example, if the user goes offline).</p><p>If users attempt to make more concurrent requests than their policy allows, the new connection attempt fails and the Exchange server will log the <strong>9646 event</strong>&nbsp;. However, the existing connections remain valid. The <strong><em>RCAMaxConcurrency</em> </strong>parameter has a valid range from 0 through 2147483647 inclusive. The default value is 20. To indicate that the number of concurrent connections should be unthrottled (no limit), this value should be set to <strong><code>$null</code></strong>.</p><p></p></p>

