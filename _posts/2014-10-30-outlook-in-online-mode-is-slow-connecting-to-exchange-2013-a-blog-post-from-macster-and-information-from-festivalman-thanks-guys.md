---
layout: post
title: Outlook in Online mode is slow connecting to Exchange 2013 – A blog post from “Macster” and information from “Festivalman”, thanks guys !
date: 2014-10-30 07:34
author: sammykrosoft
comments: true
categories: [Uncategorized]
---
<p>&nbsp;<p>&nbsp;</p><p><font size="3">Thanks </font><a href="http://community.spiceworks.com/profile/show/macster"><font size="3">Macster</font></a><font size="3"> and </font><a href="https://social.technet.microsoft.com/profile/festivalman/?ws=usercard-mini"><font size="3">Festivalman</font></a><font size="3"> for this tip !</font></p><p>&nbsp;</p><p><font size="3"><u>Before applying this TCP Ack solution, the below conditions must be met</u>:</font></p><p>-<font size="3"> OWA connection and mail browsing is very fine, whereas an Outlook online mode (i.e. not cached mode) connectivity is quite sluggish when mailboxes are on Exchange 2013&hellip;</font> </p><p><font size="3">- If OWA is slow as well, then the issue may be a general network slowness issue &ndash; check the network latency using <strong>Ping</strong> or </font><a href="http://technet.microsoft.com/en-ca/sysinternals/jj729731.aspx"><font size="3">PsPing</font></a><font size="3"> (Advanced ping tool from Windows SysInternals)</font></p><p><font size="3">- On Outlook Connection Status dialog box (CTRL+Right Click the Outlook icon on the Windows notifications part of the taskbar), Avg. Proc. time is fine, below 50~60ms, and Avg. Resp. time is over 110ms.</font></p><p>&nbsp;</p><p><font size="3"><strong><u>Cause:</u></strong> </font></p><p><font size="3">Cause seems that it looks like it&rsquo;s caused by the 200ms timeout setting on ACKs, probably causing more TCP retransmits &ndash; using Netmon and an Outlook connecting to an Exchange 2013 lab infrastructure may confirm that point &hellip;</font></p><p><font size="3">To summarize Macster and Festivalman findings, the solution is to create a TcpAckFrequency registry key and set it to 1.</font></p><p><font size="3">&nbsp; </font></p><p><strong><u><font size="3">Recommendation:</font></u></strong></p><p><font size="3">My recommendation is not to change this registry key on the desktop(s) until you confirmed the behavior using a Network Trace, and until you are falling Under the above mentionned conditions (especially OWA browsing is fine, Outlook online browsing is slow)</font></p><p>&nbsp;</p><p><font size="3"><strong><u>More information about the TcpAckFrequency registry key:</u></strong></font></p><p><font size="3">Quoting from <a title="http://support2.microsoft.com/kb/328890" href="http://support2.microsoft.com/kb/328890">http://support2.microsoft.com/kb/328890</a>:</font></p><p>- TcpAckFrequency is a registry entry that determines the number of TCP acknowledgments (ACKs) that will be outstanding before the delayed ACK timer is ignored.</p><p>- TCP uses delayed acknowledgments to reduce the number of packets that are sent on the media (Wifi, Wire,&hellip;)</p><p>- As data is received by TCP on a particular connection, it sends an acknowledgment back only if one of the following conditions is true: </p><ul>   <li>No acknowledgment was sent for the previous segment received. </li>    <li>A segment is received, but no other segment arrives within 200 milliseconds for that connection.</li> </ul><p>Typically, an acknowledgment is sent for every other TCP segment that is received on a connection unless the delayed ACK timer (200 milliseconds) expires. </p><p>- You can adjust the delayed ACK timer by editing the following registry entry.</p><p><em><u>Subkey:</u> </em></p><p><em>HKEY_LOCAL_MACHINESYSTEMCurrentControlSetServicesTcpipParametersInterfaces&lt;Interface GUID&gt;</em></p><p><em><u>Entry:</u> </em></p><p><em>TcpAckFrequency</em></p><p><em><u>Value Type:</u> REG_DWORD, number       <br><u>Valid Range:</u> 0-255       <br><u>Default:</u> 2       <br><u>Description:</u> Specifies the number of ACKs that will be outstanding before the delayed ACK timer is ignored. Microsoft does not recommend changing the default value without careful study of the environment.</em></p><p>&nbsp;</p><p>&nbsp; </p><p><font size="3"><strong><u>More explanations and complete solution:</u></strong></font></p><p><a href="http://community.spiceworks.com/topic/571571-outlook-slow-after-migrating-to-exchange-2013"><font color="#000000" size="3">Outlook slow after migrating to Exchange 2013</font></a></p><p><a title="http://community.spiceworks.com/topic/571571-outlook-slow-after-migrating-to-exchange-2013" href="http://community.spiceworks.com/topic/571571-outlook-slow-after-migrating-to-exchange-2013"><font size="3">http://community.spiceworks.com/topic/571571-outlook-slow-after-migrating-to-exchange-2013</font></a></p><p><font size="3"></font></p><p><font size="3"><strong>Slow online mode "browsing"</strong></font></p><p><a title="https://social.technet.microsoft.com/Forums/office/en-US/0d45b1b0-3047-4666-ad04-217e98ed8823/slow-online-mode-browsing?forum=exchangesvrclients" href="https://social.technet.microsoft.com/Forums/office/en-US/0d45b1b0-3047-4666-ad04-217e98ed8823/slow-online-mode-browsing?forum=exchangesvrclients"><font size="3">https://social.technet.microsoft.com/Forums/office/en-US/0d45b1b0-3047-4666-ad04-217e98ed8823/slow-online-mode-browsing?forum=exchangesvrclients</font></a></p><p><font size="3"></font></p><p><font size="3">Again, to give back to Caesar what belong to Caesar, thanks to </font><a href="http://community.spiceworks.com/profile/show/macster"><font size="3">Macster</font></a><font size="3"> and </font><a href="https://social.technet.microsoft.com/profile/festivalman/?ws=usercard-mini"><font size="3">Festivalman</font></a><font size="3"> for sharing this finding ! That will save trouble for many people out there !</font></p><p><font size="3"></font></p><p><font size="3">Cheers,</font></p><p><font size="3">Sam.</font></p></p>

