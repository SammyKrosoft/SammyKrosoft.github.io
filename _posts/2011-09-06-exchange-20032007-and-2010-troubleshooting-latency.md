---
layout: post
title: Exchange 2003–2007 and 2010 – Troubleshooting steps for client connection or latency issues on the Server side – nothing complicated at all, just follow the process !
date: 2011-09-06 19:52
author: sammykrosoft
comments: true
categories: [Uncategorized]
---
<p>&#160;</p>  <p>Users experiencing issues connecting or using Exchange messaging service via Outlook or OWA ? Here is how to sort this out on most of the cases :</p>  <p>· First thing to look at is the Application Log, then the System Log,.</p>  <p>· Second thing to look at are the performance counters to check if we have RPC latencies (as all the actions an Exchange user is doing corresponds to RPC requests being sent to the Exchange server). The methodology is the following :</p>  <p>o Check for RPC latencies</p>  <p>o Check for CPU performance issues</p>  <p>o Check for Memory load issues</p>  <p>o Check for Disk bound issues</p>  <p>o Check for Network issues</p>  <p>o Check for Active Directory related issues</p>  <p>o Check for Virus scanning issues</p>  <p>A list of the most important counters has to be built for future reference, but the thing is, if an issue is not visible in the Application or System Log, then the Performance logging analysis will point the cause of the issue on most of the time, provided you use the correct methodology as introduced above.</p>  <p>&#160;</p>  <p>· Performance analysis enable to fine-tune Exchange components analysis. For example, if users are still able to connect to the Exchange server, but they encounter huge latencies, THEN performance analysis with the right counters will tell you where the issue is.</p>  <p>o As there are hundreds of counters on an Exchange Server : Disks, Memory, Processor Exchange components, …, it is essential to have a subset of counters to begin with the performance anlaysis. That is the easiest and more effective approach.</p>  <p>o Once the component causing the Exchange issue (Disk, Memory, Network, etc…) has been identified, then we can dig further in the analysis of this component by using more of this component’s counters. For example, for the Memory component, we must check the “Available MB” and “Pages/Sec” counters, and if one of these shows an issue, then we will add more Memory counters (total counters for the Memory component is 35 ! That’s why we start with only 2 counters, Available MB and Pages/Sec. The principle is the same for all other components : take 2 to 4 significant counters, then dig further)</p>  <p>&#160;</p>  <p>Here is the list of Exchange 2007 counters that will help pointing out where the issue is – I will post a link to my Excel spreadsheet if you ask, I promise ! (I currently have the same for Exchange 2003 – for Exchange 2010, take the same counters as for Exchange 2007 – I am in the process of updating the Exchange 2010 spreadsheet to have a consistent/complete Excel tool) :</p>  <p>Part I :</p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/3173.Performance%20Exchange%20part%20I_2.jpg" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/3173.Performance-Exchange-part-I_5F00_2.jpg"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Performance Exchange part I" border="0" alt="Performance Exchange part I" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/7282.Performance%20Exchange%20part%20I_thumb.jpg" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/7282.Performance-Exchange-part-I_5F00_thumb.jpg" width="204" height="244" /></a></p>  <p>&#160;</p>  <p>Part II :</p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/6138.Performance%20Exchange%20part%20II_2.jpg" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/6138.Performance-Exchange-part-II_5F00_2.jpg"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Performance Exchange part II" border="0" alt="Performance Exchange part II" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/4087.Performance%20Exchange%20part%20II_thumb.jpg" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/4087.Performance-Exchange-part-II_5F00_thumb.jpg" width="174" height="244" /></a></p>  <p>&#160;</p>  <p>Part II :</p>  <p><a href="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/3007.Performance%20Exchange%20part%20III_2.jpg" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/3007.Performance-Exchange-part-III_5F00_2.jpg"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Performance Exchange part III" border="0" alt="Performance Exchange part III" src="https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/73/61/metablogapi/8284.Performance%20Exchange%20part%20III_thumb.jpg" original-url="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-73-61-metablogapi/8284.Performance-Exchange-part-III_5F00_thumb.jpg" width="244" height="57" /></a></p>
