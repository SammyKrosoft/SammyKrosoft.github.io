---
layout: post
title: PowerShell post - GUI Pause to give user choice to continue or abort a PowerShell script execution
date: 2017-11-22 15:46
author: sammykrosoft
comments: true
categories: [Uncategorized]
---
Hi all, this post is to show you how to use a GUI pause, basically a message box which when you call it, it’s asking you to continue (click “Ok”) or abort (click “Cancel”) a script or a set of PowerShell instructions

Just put the below function in the beginning of your script, or in the “Functions” definitions area of your script, and just call the function name (GUIPAUSE in the below example) whenever you wish to continue or abort the running script / set of instructions :
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #98fb98">#region BEGIN PAUSE FUNCTION DEFINITION</span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span style="font-family: 'Lucida Console'"><span><span style="color: #e0ffff"><span style="font-size: 9pt">Function</span></span></span><span><span style="font-size: 9pt"><span style="color: #000000"> </span><span><span style="color: #ee82ee">GUIPAUSE</span></span><span style="color: #000000"> </span><span><span style="color: #f5f5f5">(</span></span><span><span style="color: #ff4500">$Message</span></span><span style="color: #000000"> </span><span><span style="color: #d3d3d3">=</span></span><span style="color: #000000"> </span><span><span style="color: #db7093">"Click OK to continue or CANCEL to exit script"</span></span><span><span style="color: #d3d3d3">,</span></span><span style="color: #000000"> </span><span><span style="color: #ff4500">$Title</span></span><span style="color: #000000"> </span><span><span style="color: #d3d3d3">=</span></span><span style="color: #000000"> </span><span><span style="color: #db7093">"Continue or Cancel"</span></span><span><span style="color: #f5f5f5">)</span></span><span style="color: #000000"> </span></span><span><span style="font-size: 9pt;color: #f5f5f5">{</span></span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #f5f5f5"> </span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span><span style="color: #000000"><span style="font-size: 9pt">    <span style="color: #ffff00"><span lang="EN"><span>Add-Type</span></span><span lang="EN"> </span><span lang="EN"><span>-AssemblyName</span></span><span lang="EN"> </span><span lang="EN"><span>System.Windows.Forms</span></span></span></span></span></span><span style="font-size: 9pt"><span style="color: #ffff00"><span> </span></span><span><span style="color: #d3d3d3">|</span></span><span style="color: #000000"> </span></span><span><span style="font-size: 9pt;color: #e0ffff">Out-Null</span></span></span><span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span><span style="color: #000000"><span style="font-size: 9pt">    </span></span></span><span style="font-size: 9pt"><span><span style="color: #ff4500">$MsgBox</span></span><span style="color: #000000"> </span><span><span style="color: #d3d3d3">=</span></span><span style="color: #000000"> </span><span><span style="color: #d3d3d3">[</span></span><span><span style="color: #8fbc8f">System.Windows.Forms.MessageBox</span></span></span><span><span style="font-size: 9pt;color: #d3d3d3">]</span></span></span><span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #f5f5f5"> </span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span><span style="color: #000000"><span style="font-size: 9pt">    </span></span></span><span style="font-size: 9pt"><span><span style="color: #ff4500">$Decision</span></span><span style="color: #000000"> </span><span><span style="color: #d3d3d3">=</span></span><span style="color: #000000"> </span><span><span style="color: #ff4500">$MsgBox</span></span><span><span style="color: #d3d3d3">::</span></span><span><span style="color: #f5f5f5">Show(</span></span><span><span style="color: #ff4500">$Message</span></span><span><span style="color: #d3d3d3">,</span></span><span><span style="color: #ff4500">$Title</span></span><span><span style="color: #d3d3d3">,</span></span><span><span style="color: #db7093">"OkCancel"</span></span><span><span style="color: #d3d3d3">,</span></span><span style="color: #000000"> </span><span><span style="color: #db7093">"Information"</span></span></span><span><span style="font-size: 9pt;color: #f5f5f5">)</span></span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span><span style="color: #000000"><span style="font-size: 9pt">    </span></span></span><span style="font-size: 9pt"><span><span style="color: #e0ffff">If</span></span><span style="color: #000000"> </span><span><span style="color: #f5f5f5">(</span></span><span><span style="color: #ff4500">$Decision</span></span><span style="color: #000000"> </span><span><span style="color: #d3d3d3">-eq</span></span><span style="color: #000000"> </span><span><span style="color: #db7093">"Cancel"</span></span><span><span style="color: #f5f5f5">)</span></span><span style="color: #000000"> </span><span><span style="color: #f5f5f5">{</span></span><span><span style="color: #e0ffff">exit</span></span></span><span><span style="font-size: 9pt;color: #f5f5f5">}</span></span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #f5f5f5"> </span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #f5f5f5">}</span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #98fb98">#endregion</span></span></span></p>
To customize the Pause message you can use the following synthax when calling the “GUIPAUSE” function :
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="color: #98fb98"><span style="font-size: 9pt">GUIPAUSE -Message "MyMessage" -Title "MyTitle"</span></span></span></span></p>
<span></span>

<span>Examples:</span>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="color: #98fb98"><span style="font-size: 9pt">GUIPAUSE</span></span></span></span></p>
<span>=&gt; launches the Pause window with "OK" and "Cancel" to continue or abort the script</span>

<a href="https://msdnshared.blob.core.windows.net/media/2017/11/image342.png"><img title="image" style="padding-top: 0px;padding-left: 0px;margin: 0px;padding-right: 0px;border: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2017/11/image_thumb286.png" width="244" height="122" /></a>

<span></span>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="color: #98fb98"><span style="font-size: 9pt">GUIPAUSE -Message "I Love PowerShell ... click OK to continue or Cancel to abort script" -Title "Another Title"</span></span></span></span></p>
<span>=&gt; same as above with custom message and box title</span>

<a href="https://msdnshared.blob.core.windows.net/media/2017/11/image343.png"><img title="image" style="padding-top: 0px;padding-left: 0px;margin: 0px;padding-right: 0px;border: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2017/11/image_thumb287.png" width="244" height="94" /></a>

<span style="font-size: 9pt;color: #98fb98"><span style="font-family: 'Lucida Console'"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #98fb98"></span></span></span></span></span>

<span>In the below example, after printing each line, you’ll get a Pop-Up to ask you to continue or to abort/cancel the script execution (you must have registered the GUIPAUSE function before)…</span>

&nbsp;
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #98fb98"># SAMPLE CODE TO ILLUSTRATE GUIPAUSE #</span></span></span><span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #f5f5f5"> </span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span style="font-family: 'Lucida Console'"><span><span style="color: #e0ffff"><span style="font-size: 9pt">Write-host</span></span></span><span><span style="font-size: 9pt"><span style="color: #000000"> </span></span><span><span style="font-size: 9pt;color: #db7093">"Coucou ! Script launched"</span></span><span></span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #f5f5f5"> </span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #e0ffff">GUIPAUSE</span></span></span><span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #f5f5f5"> </span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span style="font-family: 'Lucida Console'"><span><span style="color: #e0ffff"><span style="font-size: 9pt">Write-Host</span></span></span><span><span style="font-size: 9pt"><span style="color: #000000"> </span></span><span><span style="font-size: 9pt;color: #db7093">"Continuing ... instruction 001"</span></span><span></span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #f5f5f5"> </span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #e0ffff">GUIPAUSE</span></span></span><span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #f5f5f5"> </span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span style="font-family: 'Lucida Console'"><span><span style="color: #e0ffff"><span style="font-size: 9pt">Write-Host</span></span></span><span><span style="font-size: 9pt"><span style="color: #000000"> </span></span><span><span style="font-size: 9pt;color: #db7093">"Continuing again ... instruction 002"</span></span><span></span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #f5f5f5"> </span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #e0ffff">GUIPAUSE</span></span></span><span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span style="font-family: 'Lucida Console'"><span style="font-size: 9pt;color: #f5f5f5"> </span></span></span></p>
<p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span style="font-family: 'Lucida Console'"><span><span style="color: #e0ffff"><span style="font-size: 9pt">Write-Host</span></span></span><span><span style="font-size: 9pt"><span style="color: #000000"> </span></span><span><span style="font-size: 9pt;color: #db7093">"Ending ... Instruction 003" </span></span></span></span></p>
