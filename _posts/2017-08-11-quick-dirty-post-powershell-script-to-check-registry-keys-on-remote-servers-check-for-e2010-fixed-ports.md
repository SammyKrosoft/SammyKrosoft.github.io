---
layout: post
title: Quick dirty post–Powershell Script to check registry keys on remote servers (check for E2010 fixed ports)
date: 2017-08-11 12:50
author: sammykrosoft
comments: true
categories: [Uncategorized]
---
<p>Hi all,  <p>I know Exchange 2010 is almost outdated, but that’s just for my reference and also for an example about how to query registry keys at the same time : this script checks servers for specific registry keys, in this example it checks for the registry keys we used in Exchange 2010 to fix ports, which were done for 2 Exchange components (Store and Address Book), using 2 registry keys – More information about <a href="https://social.technet.microsoft.com/wiki/contents/articles/864.configure-static-rpc-ports-on-an-exchange-2010-client-access-server.aspx">how to fix E2010 ports here</a>.  <p>&nbsp; <p>Apologize for the drafty post, but again, it’s just for future reference about how to query registry keys in general…  <p class="MsoNormal" style="margin: 0cm 0cm 8pt;line-height: 12pt">&nbsp;</p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#f5f5f5">&nbsp;</font></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#98fb98">############################################## Script Start ##############################################</font></font></span><span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#98fb98"># HOW TO check registry keys</font></font></span><span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#98fb98"># In the below example: check for Ports fixed for Client Access ....</font></font></span><span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#98fb98">#</font></font></span><span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#98fb98"># WARNING : Script Requires Exchange tools to get list of Exchange if you use Get-ClientAccessServer or Get-ExchangeServer</font></font></span><span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#98fb98"># NOTE: Script does NOT require EXchange tools if you use a Powershell list you put in a variable like $ExchangeServers = "Server1", "Server2", "Server3" </font></font></span><span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#f5f5f5">&nbsp;</font></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#f5f5f5">&nbsp;</font></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#98fb98">#Initializing variable - best practice of developpers and just in case</font></font></span><span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><font face="Lucida Console"><span><font color="#ff4500"><font style="font-size: 9pt">$MSExch1</font></font></span><span><font style="font-size: 9pt"><font color="#000000"> </font><span style="color:"><font color="#d3d3d3">=</font></span><font color="#000000"> </font></font><span style="color:"><font style="font-size: 9pt" color="#ff4500">$null</font></span><span style="color:"></span></span></font></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><font face="Lucida Console"><span><font color="#ff4500"><font style="font-size: 9pt">$MSExch2</font></font></span><span><font style="font-size: 9pt"><font color="#000000"> </font><span style="color:"><font color="#d3d3d3">=</font></span><font color="#000000"> </font></font><span style="color:"><font style="font-size: 9pt" color="#ff4500">$null</font></span><span style="color:"></span></span></font></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><font face="Lucida Console"><span><font color="#ff4500"><font style="font-size: 9pt">$MSExch2type</font></font></span><span><font style="font-size: 9pt"><font color="#000000"> </font><span style="color:"><font color="#d3d3d3">=</font></span><font color="#000000"> </font></font><span style="color:"><font style="font-size: 9pt" color="#ff4500">$null</font></span><span style="color:"></span></span></font></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><font face="Lucida Console"><span><font color="#ff4500"><font style="font-size: 9pt">$ExchangeServers</font></font></span><span><font style="font-size: 9pt"><font color="#000000"> </font><span style="color:"><font color="#d3d3d3">=</font></span><font color="#000000"> </font></font><span style="color:"><font style="font-size: 9pt" color="#ff4500">$null</font></span><span style="color:"></span></span></font></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><font face="Lucida Console"><span><font color="#ff4500"><font style="font-size: 9pt">$Reg</font></font></span><span><font style="font-size: 9pt"><font color="#000000"> </font><span style="color:"><font color="#d3d3d3">=</font></span><font color="#000000"> </font></font><span style="color:"><font style="font-size: 9pt" color="#ff4500">$null</font></span><span style="color:"></span></span></font></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><font face="Lucida Console"><span><font color="#ff4500"><font style="font-size: 9pt">$RegKey</font></font></span><span><font style="font-size: 9pt"><font color="#000000"> </font><span style="color:"><font color="#d3d3d3">=</font></span><font color="#000000"> </font></font><span style="color:"><font style="font-size: 9pt" color="#ff4500">$null</font></span><span style="color:"></span></span></font></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><font face="Lucida Console"><span><font color="#ff4500"><font style="font-size: 9pt">$computer</font></font></span><span><font style="font-size: 9pt"><font color="#000000"> </font><span style="color:"><font color="#d3d3d3">=</font></span><font color="#000000"> </font></font><span style="color:"><font style="font-size: 9pt" color="#ff4500">$null</font></span><span style="color:"></span></span></font></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#f5f5f5">&nbsp;</font></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#98fb98"># 3 methods to get Exchange CAS servers : </font></font></span><span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#98fb98"># - filter on the "ServerRole" property of an entire "ExchangeServer" object - PROS: if you have mix of Exchange 2007/2010 servers, you can add an "AdminDisplayVersion" filter to query only the Exchange version you want to check !</font></font></span><span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#98fb98"># - just do a "Get-ClientAccessServer" - PROS : simpler ! But in case you have mix of E2010/E2007 servers, you'll check all of these</font></font></span><span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#98fb98"># - give a list of machines to the $ExchangeServers variable like $ExchangeServers = "Server1", "Server2", "Server3"</font></font></span><span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#f5f5f5">&nbsp;</font></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#98fb98"># $ExchangeServers = get-exchangeserver | ? {$_.ServerRole -like "*ClientAccess*" -and $_.AdminDisplayVersion -like "*14.*"} #$ExchangeServers = Get-ClientAccessServer</font></font></span><span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#98fb98"># $ExchangeServers = "Server1", "Server2", "Server3"</font></font></span><span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#98fb98"># $ExchangeServers = Get-ClientAccessServer</font></font></span><span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#f5f5f5">&nbsp;</font></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><font face="Lucida Console"><span><font color="#ff4500"><font style="font-size: 9pt">$ExchangeServers</font></font></span><span><font style="font-size: 9pt"><font color="#000000"> </font><span style="color:"><font color="#d3d3d3">=</font></span><font color="#000000"> </font></font><span style="color:"><font style="font-size: 9pt" color="#e0ffff">Get-ClientAccessServer</font></span><span style="color:"></span></span></font></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#f5f5f5">&nbsp;</font></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#f5f5f5">&nbsp;</font></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#98fb98"># Here is where, for each computer on the list in the $ExchangeServers variable, we query the registry keys</font></font></span><span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><font face="Lucida Console"><span><font color="#e0ffff"><font style="font-size: 9pt">foreach</font></font></span><span><font style="font-size: 9pt"><font color="#000000"> </font><span style="color:"><font color="#f5f5f5">(</font></span><span style="color:"><font color="#ff4500">$computer</font></span><font color="#000000"> </font><span style="color:"><font color="#e0ffff">in</font></span><font color="#000000"> </font><span style="color:"><font color="#ff4500">$ExchangeServers</font></span></font><span style="color:"><font style="font-size: 9pt" color="#f5f5f5">){</font></span></span></font></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9pt"><span style="color:"><font color="#e0ffff">Write-host</font></span><font color="#000000"> </font><span style="color:"><font color="#db7093">"Checking computer </font></span><span style="color:"><font color="#ff4500">$Computer</font></span></font><span style="color:"><font style="font-size: 9pt" color="#db7093">"</font></span></font><span style="color:"></span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp; </font></font></span><span style="color:"><font style="font-size: 9pt" color="#98fb98">#We check if the computer is reachable - if it is, we continue, if it is not, we print "Computer is down" and move on...</font></span></font><span style="color:"></span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9pt"><span style="color:"><font color="#e0ffff">if</font></span><font color="#000000"> </font><span style="color:"><font color="#f5f5f5">(</font></span><span style="color:"><font color="#e0ffff">test-connection</font></span><font color="#000000"> </font><span style="color:"><font color="#ff4500">$computer</font></span><font color="#000000"> </font><span style="color:"><font color="#ffe4b5">-quiet</font></span><font color="#000000"> </font><span style="color:"><font color="#ffe4b5">-count</font></span><font color="#000000"> </font><span style="color:"><font color="#ffe4c4">1</font></span><span style="color:"><font color="#f5f5f5">)</font></span><font color="#000000"> </font></font><span style="color:"></span></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp; </font></font></span><span style="color:"><font style="font-size: 9pt" color="#f5f5f5">{</font></span></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span><font face="Lucida Console"><font style="font-size: 9pt" color="#000000">&nbsp;&nbsp;&nbsp; </font></font></span><span style="color:"></span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><span style="color:"><font style="font-size: 9pt" color="#98fb98">#First we open the registry on the remote computer - note the ".NET" notation [Object.Properties]::Function([parameters]) ...</font></span></font><span style="color:"></span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9pt"><span style="color:"><font color="#ff4500">$Reg</font></span><font color="#000000"> </font><span style="color:"><font color="#d3d3d3">=</font></span><font color="#000000"> </font><span style="color:"><font color="#d3d3d3">[</font></span><span style="color:"><font color="#8fbc8f">Microsoft.Win32.RegistryKey</font></span><span style="color:"><font color="#d3d3d3">]::</font></span><span style="color:"><font color="#f5f5f5">OpenRemoteBaseKey(</font></span><span style="color:"><font color="#db7093">'LocalMachine'</font></span><span style="color:"><font color="#d3d3d3">,</font></span><font color="#000000"> </font><span style="color:"><font color="#ff4500">$computer</font></span></font><span style="color:"><font style="font-size: 9pt" color="#f5f5f5">)</font></span></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><span style="color:"><font style="font-size: 9pt" color="#98fb98">#Second we open or navigate to the key where we know we'll find the registry object to query</font></span></font><span style="color:"></span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9pt"><span style="color:"><font color="#ff4500">$RegKey</font></span><span style="color:"><font color="#d3d3d3">=</font></span><font color="#000000"> </font><span style="color:"><font color="#ff4500">$Reg</font></span><span style="color:"><font color="#d3d3d3">.</font></span><span style="color:"><font color="#f5f5f5">OpenSubKey(</font></span><span style="color:"><font color="#db7093">"SYSTEM\\CurrentControlSet\\services\\MSExchangeRPC\\ParametersSystem"</font></span></font><span style="color:"><font style="font-size: 9pt" color="#f5f5f5">)</font></span></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><span style="color:"><font style="font-size: 9pt" color="#98fb98">#Third we query the value and the type (DWORD, REG_SZ or whatever) of the key we want (we pass the key name inside the GetValue function)</font></span></font><span style="color:"></span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font color="#000000"><span><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9pt"><span>&nbsp;</span></font></font><font style="font-size: 9pt"><span style="color:"><font color="#ff4500">$MSExch1</font></span><font color="#000000"> </font><span style="color:"><font color="#d3d3d3">=</font></span><font color="#000000"> </font><span style="color:"><font color="#ff4500">$RegKey</font></span><span style="color:"><font color="#d3d3d3">.</font></span><span style="color:"><font color="#f5f5f5">GetValue(</font></span><span style="color:"><font color="#db7093">"TCP/IP Port"</font></span></font><span style="color:"><font style="font-size: 9pt" color="#f5f5f5">)</font></span></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9pt"><span style="color:"><font color="#ff4500">$MSExch1type</font></span><font color="#000000"> </font><span style="color:"><font color="#d3d3d3">=</font></span><font color="#000000"> </font><span style="color:"><font color="#ff4500">$RegKey</font></span><span style="color:"><font color="#d3d3d3">.</font></span><span style="color:"><font color="#f5f5f5">GetValueKind(</font></span><span style="color:"><font color="#db7093">"TCP/IP Port"</font></span></font><span style="color:"><font style="font-size: 9pt" color="#f5f5f5">)</font></span></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span><font face="Lucida Console"><font style="font-size: 9pt" color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><span style="color:"></span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#f5f5f5">&nbsp;</font></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><span style="color:"><font style="font-size: 9pt" color="#98fb98">#Then we repeat the above for other registry keys...</font></span></font><span style="color:"></span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9pt"><span style="color:"><font color="#ff4500">$RegKey</font></span><font color="#000000"> </font><span style="color:"><font color="#d3d3d3">=</font></span><font color="#000000"> </font><span style="color:"><font color="#ff4500">$Reg</font></span><span style="color:"><font color="#d3d3d3">.</font></span><span style="color:"><font color="#f5f5f5">OpenSubKey(</font></span><span style="color:"><font color="#db7093">"SYSTEM\\CurrentControlSet\\services\\MSExchangeAB\\Parameters"</font></span></font><span style="color:"><font style="font-size: 9pt" color="#f5f5f5">)</font></span></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9pt"><span style="color:"><font color="#ff4500">$MSExch2</font></span><font color="#000000"> </font><span style="color:"><font color="#d3d3d3">=</font></span><font color="#000000"> </font><span style="color:"><font color="#ff4500">$RegKEy</font></span><span style="color:"><font color="#d3d3d3">.</font></span><span style="color:"><font color="#f5f5f5">GetValue(</font></span><span style="color:"><font color="#db7093">"RpcTcpPort"</font></span></font><span style="color:"><font style="font-size: 9pt" color="#f5f5f5">)</font></span></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9pt"><span style="color:"><font color="#ff4500">$MSExch2type</font></span><font color="#000000"> </font><span style="color:"><font color="#d3d3d3">=</font></span><font color="#000000"> </font><span style="color:"><font color="#ff4500">$RegKey</font></span><span style="color:"><font color="#d3d3d3">.</font></span><span style="color:"><font color="#f5f5f5">GetValueKind(</font></span><span style="color:"><font color="#db7093">"RpcTcpPort"</font></span></font><span style="color:"><font style="font-size: 9pt" color="#f5f5f5">)</font></span></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span><font face="Lucida Console"><font style="font-size: 9pt" color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><span style="color:"></span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><span style="color:"><font style="font-size: 9pt" color="#98fb98">#We then just pring the value and valuetype on the console, with some fancy colors (Magenta here)</font></span></font><span style="color:"></span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9pt"><span style="color:"><font color="#e0ffff">Write-Host</font></span><font color="#000000"> </font><span style="color:"><font color="#db7093">"MSExchangeIS Port = </font></span><span style="color:"><font color="#ff4500">$MSExch1</font></span><span style="color:"><font color="#db7093"> / Type = </font></span><span style="color:"><font color="#ff4500">$MSExch1type</font></span><span style="color:"><font color="#db7093">"</font></span><font color="#000000"> </font><span style="color:"><font color="#ffe4b5">-foregroundcolor</font></span><font color="#000000"> </font></font><span style="color:"><font style="font-size: 9pt" color="#ee82ee">magenta</font></span></font><span style="color:"></span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9pt"><span style="color:"><font color="#e0ffff">Write-Host</font></span><font color="#000000"> </font><span style="color:"><font color="#db7093">"MSExchangeAB Port = </font></span><span style="color:"><font color="#ff4500">$MSExch2</font></span><span style="color:"><font color="#db7093"> / Type = </font></span><span style="color:"><font color="#ff4500">$MSExch2type</font></span><span style="color:"><font color="#db7093">"</font></span><font color="#000000"> </font><span style="color:"><font color="#ffe4b5">-foregroundcolor</font></span><font color="#000000"> </font></font><span style="color:"><font style="font-size: 9pt" color="#ee82ee">magenta</font></span></font><span style="color:"></span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#f5f5f5">&nbsp;</font></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp; </font></font></span><span style="color:"><font style="font-size: 9pt" color="#f5f5f5">}</font></span></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9pt"><span style="color:"><font color="#e0ffff">else</font></span><font color="#000000"> </font></font><span style="color:"></span></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp; </font></font></span><span style="color:"><font style="font-size: 9pt" color="#f5f5f5">{</font></span></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9pt"><span style="color:"><font color="#e0ffff">Write-Host</font></span><font color="#000000"> </font><span style="color:"><font color="#db7093">"</font></span><span style="color:"><font color="#ff4500">$computer</font></span><span style="color:"><font color="#db7093"> is down"</font></span><font color="#000000"> </font><span style="color:"><font color="#ffe4b5">-foregroundcolor</font></span><font color="#000000"> </font></font><span style="color:"><font style="font-size: 9pt" color="#ee82ee">RED</font></span></font><span style="color:"></span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><span><font color="#000000"><font style="font-size: 9pt">&nbsp;&nbsp;&nbsp; </font></font></span><span style="color:"><font style="font-size: 9pt" color="#f5f5f5">}</font></span></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#f5f5f5">}</font></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#f5f5f5">&nbsp;</font></font></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><font face="Lucida Console"><font style="font-size: 9pt" color="#98fb98">############################################## Script End ##############################################</font></font></span><span></span></p> <p class="MsoNormal" style="background: #012456;margin: 0cm 0cm 0pt;line-height: normal"><span><span><font face="Lucida Console"><font style="font-size: 9pt" color="#f5f5f5">&nbsp;</font></font></span></span></p> <p class="MsoNormal" style="margin: 0cm 0cm 8pt;line-height: 12pt"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&nbsp;</font></font></p> <p class="MsoNormal" style="margin: 0cm 0cm 8pt;line-height: 12pt">&nbsp;</p> <p class="MsoNormal" style="margin: 0cm 0cm 8pt;line-height: 12pt"><font color="#000000" face="Calibri">Have fun !</font></p> <p class="MsoNormal" style="margin: 0cm 0cm 8pt;line-height: 12pt"><font color="#000000" face="Calibri">Cheers,</font></p> <p class="MsoNormal" style="margin: 0cm 0cm 8pt;line-height: 12pt"><font color="#000000" face="Calibri">Sam</font></p>
